webpackJsonp([6],[function(e,t,n){(function(e){"use strict";function t(){var t=parseInt(e("[name=current]:input").val()),n=parseInt(e("[name=objective]:input").val()),o=(new Date).getTime(),r=m.reduce(function(e,t){return e+Math.max(t[1],o)-Math.max(t[0],o)},0),a=Math.max(n-t,0),s=r/864e5,l=a/Math.max(s,1),u=r/36e5,c=a/Math.max(u,1),p=r/18e5,h=a/Math.max(p,1),d=i(l,3).split(".");e("#norma_per_day").find(".norma-amount-actual").text(d[0]).parent().find(".norma-amount-fraction").text("."+d[1]).parent(),d=i(c,3).split("."),e("#norma_per_hour").find(".norma-amount-actual").text(d[0]).parent().find(".norma-amount-fraction").text("."+d[1]).parent(),d=i(h,3).split("."),e("#norma_per_minute").find(".norma-amount-actual").text(d[0]).parent().find(".norma-amount-fraction").text("."+d[1]).parent(),e("#remains_days").text(i(s,0)),e("#remains_hours").text(i(u,0)),e("#remains_minutes").text(i(60*u,0));var f,v=100*Math.min(t,n),g=parseInt(v/n)||0,y=P-r,b=parseInt(100*y/P)||0;f=100==g?"progress-bar-success":g>=b?"progress-bar-success":g>.7*b?"progress-bar-info":g>.4*b?"progress-bar-warning":"progress-bar-danger",e("#objective_progress > .progress-bar").width(g+"%").removeClass("progress-bar-success progress-bar-info progress-bar-danger progress-bar-warning").addClass(f).children("span").text(g+"%達成"),e("#period_progress > .progress-bar").width(b+"%").children("span").text(b+"%経過");var _=t*P/y;e("#prediction_collection").text(i(Math.floor(_)));var x=Math.min(_/n,1),w=e("#objective_progress").width(),E=w*x-47;e(".pointer").css("left",E+"px");var C=230>w-E?-250:0;e(".pointer-label").css("margin-left",C+"px");var N="";if(n>t&&_>=n){var D,k;m.forEach(function(e){D=D||e[0],k=k||e[1]});var T=n/_*P,O=m.reduce(function(e,t){if(e)return e;var n=t[1]-t[0];return T>n?(T-=n,null):new Date(t[0]+T)},null),S=O.getMonth(),I=O.getDate(),M=O.getHours(),R=O.getMinutes(),A=S+1+"/"+I+" "+(10>M?"0"+M:M)+":"+(10>R?"0"+R:R);N=A+"頃に目標達成できそうよ。"}e("#prediction_completion_date").text(N)}function i(e,t){if(t=t||0,isNaN(e))return"?";if(e===1/0||e===-(1/0))return"∞";var n=e.toFixed(t).split("."),i=parseInt(n[0]);return i.toLocaleString()+(1===n.length?"":"."+n[1])}function o(){if(T){var t=e("#map").find("tbody tr input[name=num_drops]").map(function(){return parseInt(e(this).val())||0}).toArray().reduce(function(e,t){return e+t},0);e("input[name=current]").val(t).trigger("change")}}function r(){var t=(new Date).getTime(),n=e("#period_dates");if(m.forEach(function(i){var o=i[1]-i[0],r=100*o/P+"%",a=new Date(i[0]),s=new Date(i[1]-1),l=a.getMonth()+1+"/"+a.getDate()+"-"+(s.getMonth()+1)+"/"+s.getDate(),u=t>=i[0]&&t<i[1],c=t>=i[1],p=u?"progress-bar-active":c?"progress-bar-expired":"progress-bar-remain";e('<div class="progress-bar">').width(r).text(l).addClass(p).appendTo(n)}),e('[data-objective-mode="'+v+'"]').show(),e('[data-objective-mode][data-objective-mode!="'+v+'"]').remove(),e("[name=current]:input").click(function(){this.select()}).TouchSpin({min:0,max:g,step:1}),"achievement"==v){var r=e("[name=objective]:input");e.each(O,function(t,n){e("<option />").attr("value",t).text(n+" ("+t+"個)").appendTo(r)})}else{e("select[name=objective]").click(function(){this.select()});var y=e("#increse_objective_list");S.forEach(function(t){e('<button class="btn btn-default" name="add"  type="button" />').val(t.value).attr("title",t.name).append(e('<i class="fa fa-arrow-up" />')).append(e("<span />").addClass("icon icon-"+t.unit)).appendTo(y)})}e("button[name=add]").click(function(t){t.preventDefault();var n=parseInt(e(this).val()),i=parseInt(e("[name=objective]:input").val());e("[name=objective]:input").val(i+n).trigger("change")}),e("button[name=reset]").click(function(t){t.preventDefault(),e("[name=objective]:input").val(0).trigger("change")}),e("[name=expectation]:input").change(function(){c(),p()}).val(D);var b=e("#prize_list");S.forEach(function(t){e('<div class="prize-list" />').append(e('<h4 class="prize-list-header" />').text(t.name).append(e('<span class="prize-value" />').text("@"+t.value))).append(e('<div class="prize-list-body" />').attr("data-prize",t.unit)).appendTo(b)});var x=I.reduce(function(e,t){return Math.max(e,t.drops.length)},0),w=a();w.maps.forEach(function(e,t){I[t].expectation=e.expectation}),T=w.syncCurrentEnabled;var E,C=function(){E&&clearTimeout(E),setTimeout(function(){var t=e("#map");I.forEach(function(e,n){var o=t.find("tr[data-map="+n+"]"),r=Math.max(parseInt(o.find("input[name=num_laps]").val())||0,0),a=Math.max(parseInt(o.find("input[name=num_drops]").val())||0,0),s=o.find("input[name=actual_expectation]"),l=Math.max(parseFloat(s.val())||0,0);"aggregate"===k&&(l=a/r||0,s.val(l));var u=Math.floor(l);o.find("button[name=increase]").val(u).text("+"+i(u)),w.maps[n].numLaps=r,w.maps[n].numDrops=a,e.expectation=w.maps[n].expectation=l}),s(w),h(),c(),p()},100)},N=e("#map").on("keyup","input[type=number]",function(){C(),o()}).on("change","input[type=number]",function(){C(),o()}).on("click","input[type=number]",function(){this.select()}).on("click","button[name=increase]",function(t){t.preventDefault();var n=e(this).closest("tr"),i=n.find("input[name=num_laps]"),o=parseInt(i.val())+1;i.val(o);var r=n.find("input[name=num_drops]"),a=parseInt(r.val())+parseInt(this.value);r.val(a),r.trigger("change")}).on("change","input[name=expectation_input_mode]",function(){k=e(this).val(),w.expectationInputMode=k,s(w),N.find("input[name=num_laps], input[name=num_drops]").parent().toggle("aggregate"===k).end().end().find("input[name=actual_expectation]").parent().toggle("direct"===k).end().end().find("input[name=sync]").closest("tfoot").toggle("aggregate"===k),C()}).on("click","input[name=sync]",function(){w.syncCurrentEnabled=T=this.checked,s(w),o()}),R=N.find("tbody");if(I.forEach(function(t,n){var i=w.maps[n],o=e("<td />").attr("data-chart",n).append(e('<span class="barchart" />')).append(e('<span class="barchart-label" />')).append(e('<span class="marathon" />'));e("<tr />").attr("data-map",n).append(e("<th />").text(t.name)).append(e("<td />").text(""+t.charisma+"/"+t.stamina)).append(function(){for(var n=t.drops.map(function(t){var n=t.icon?e("<i />").attr("title",t.name).addClass("icon icon-"+t.icon):e("<span />").text(t.name),i=t.set?e('<span class="badge" />').text("x"+t.set):null;return e("<td />").append(n).append(i)}),i=t.drops.length;x>i;i++)n.push(e("<td />"));return n}).append(function(){var t=e('<span class="input-group input-group-sm" />').append(e('<span class="input-group-addon">1周の期待値</span>')).append(e('<input type="number" name="actual_expectation" min="0" class="form-control" />').val(i.expectation)),n=e('<span class="input-group input-group-sm" />').append(e('<span class="input-group-addon">周回</span>')).append(e('<input type="number" name="num_laps" min="0" class="form-control" />').val(i.numLaps)).append(e('<span class="input-group-addon">ドロップ</span>')).append(e('<input type="number" name="num_drops" min="0" class="form-control" />').val(i.numDrops)).append(e('<span class="input-group-btn"><button name="increase" class="btn btn-default"></button></span>'));return e('<td class="expectation" />').append(n).append(t)}).append(o).prependTo(R)}),e("#map thead th.drops").attr("colspan",x),_){var A=e("#rewards tbody");M.forEach(function(t){e("<tr />").attr("data-amount",t.amount).append(e('<td class="text-right" />').html('<span class="diff"></span> '+t.amount)).append(e("<td />").html('<span class="icon icon-'+t.unit+'"></span>')).appendTo(A)})}var L=e("[name=estimate_map]:input").change(function(){h(),w.estimateMap=parseInt(e(this).val()),s(w)});I.forEach(function(t,n){e("<option />").val(n).text(t.name+" ("+t.charisma+"/"+t.stamina+")").prependTo(L)});for(var V=e("[name=estimate_rank]:input").change(function(){h(),w.estimateRank=parseInt(e(this).val()),s(w)}),j=1;200>=j;j++){var F=d(j),U=f(j),z=""+j+" ("+F+"/"+U+")";e("<option />").val(j).text(z).appendTo(V)}var W=e("[name=estimate_use_crystal]").change(function(){h(),w.estimateUseCrystal=e(this).val(),s(w)}),H=e("[name=estimate_natural_recovery]:input").change(function(){h(),w.estimateNaturalRecovery=this.checked,s(w)});e("*[title]").tooltip(),e("[name=current]:input").val(w.current),"exchange"==v?e("[name=objective]:input").val(w.objective):e("[name=objective]:input").val([w.objective]),e("[name=current]:input, [name=objective]:input").change(function(){w[this.name]=e(this).val(),s(w),l(),u(),p(),h()}),L.val(w.estimateMap),V.val(w.estimateRank),W.val(w.estimateUseCrystal),H.prop("checked",w.estimateNaturalRecovery),"exchange"==v&&u(),_&&l(),N.find("input[name=sync]").prop("checked",T).end().find('input[name=expectation_input_mode][value="'+w.expectationInputMode+'"]').prop("checked",!0).trigger("change").parent().addClass("active")}function a(){var t={},n=I.map(function(e){return{numLaps:0,numDrops:0,expectation:e.expectation}}),i={current:b,objective:y,estimateMap:w,estimateRank:E,estimateUseCrystal:C,estimateNaturalRecovery:N,expectationInputMode:k,maps:n,syncCurrentEnabled:T};try{t=JSON.parse(e.cookie(x))}catch(o){}return e.extend(!0,i,t)}function s(t){e.cookie(x,JSON.stringify(t),{expires:30})}function l(){if(_){var t=45,n=7,i=parseInt(e("[name=current]:input").val()),o=e("#rewards tbody");o.find("tr").removeClass("active").each(function(){var o=e(this),r=o.attr("data-amount")-i;if(-t>r)o.hide();else if(0>r)o.css("opacity",.5).show();else if(t>r)o.addClass("active").css("opacity",1).show();else if(t*n>r){var a=1-Math.floor(r/t)*t/(t*(n+1));o.show().css("opacity",a)}else o.hide();var s=0===r?"diff-eq":r>0?"diff-plus":"diff-minus",l=0===r?"":(r>0?"+":"")+r;o.find("span.diff").removeClass("diff-eq diff-plus diff-minus").addClass(s).text(l)})}}function u(){if("exchange"==v){var t=parseInt(e("[name=current]:input").val());S.forEach(function(n){for(var i=e('[data-prize="'+n.unit+'"]').empty(),o=0;t>o;o+=n.value){var r=e("<i />").addClass("icon icon-"+n.unit),a=25*Math.min(t-o,n.value)/n.value;e('<div class="prize-gage" />').append(r.clone().css({position:"absolute",opacity:.2,boxShadow:"none",paddingRight:25-a})).append(r.clone().css({width:a+"px"})).appendTo(i)}})}}function c(){var t=e("[name=expectation]:input").val(),n=1/0,o=0,r="drop"==t?null:t,a=I.map(function(e){var t=e.expectation/(r&&e[r]||1);return n=0,o=Math.max(o,t),t}),s=r?3:2;I.forEach(function(t,r){var l=e("[data-chart="+r+"]"),u=a[r],c=u/(o-n),p=120*c+240;l.find("span.barchart-label").text(i(u,s)+"個"),l.find("span.barchart").css({width:100*c+"%",backgroundColor:"hsla("+p+", 80%, 50%, 0.5)"})})}function p(){var t=parseInt(e("[name=objective]:input").val()),n=parseInt(e("[name=current]:input").val()),o=Math.max(t-n,0);I.forEach(function(t,n){var r=e("[data-chart="+n+"]"),a=o?Math.ceil(o/t.expectation):0;r.find("span.marathon").text("残り"+i(a)+"周")})}function h(){var t=parseInt(e("[name=current]:input").val()),n=parseInt(e("[name=objective]:input").val()),o=I[parseInt(e("[name=estimate_map]:input").val())],r=Math.max(n-t,0),a=Math.ceil(r/o.expectation);e("#estimate_required_marathon").text(i(a));var s=(new Date).getTime(),l=m.reduce(function(e,t){return e+Math.max(t[1],s)-Math.max(t[0],s)},0),u=0+e("[name=estimate_natural_recovery]:input").prop("checked"),c=Math.floor(l/18e4)*u,p=Math.floor(l/36e5)*u,h=parseInt(e("[name=estimate_rank]").val()),v=d(h),g=f(h),y=Math.ceil(o.charisma*a),b=Math.ceil(o.stamina*a),_=e("[name=estimate_use_crystal]:input").val(),x=0+("both"===_||"charisma"===_),w=0+("both"===_||"stamina"===_),E=Math.ceil(Math.max(y-c,0)/v)*x,C=Math.ceil(Math.max(b-p,0)/g)*w,N=E+C;e("#estimate_required_crystal").text(i(N));var D=0===E?"diff-eq":E>0?"diff-plus":"diff-minus";e("#estimate_required_crystal_for_charisma").attr("class",D).text(i(E)),D=0===C?"diff-eq":C>0?"diff-plus":"diff-minus",e("#estimate_required_crystal_for_stamina").attr("class",D).text(i(C));var k=c+v*E,T=p+g*C,O=Math.floor(Math.min(k/o.charisma,T/o.stamina,a));e("#estimate_available_marathon").text(i(O));var S=O-a;D=0===S?"diff-eq":S>0?"diff-plus":"diff-minus";var M=(S>=0?"+":"")+i(S);e("#estimate_available_marathon_diff").attr("class",D).text(M);var P=o.charisma*O;e("#estimate_using_charisma").text(i(P)),S=P-y,D=0===S?"diff-eq":S>0?"diff-plus":"diff-minus",M=(S>=0?"+":"")+i(S),e("#estimate_using_charisma_diff").attr("class",D).text(M);var R=Math.ceil(o.stamina*O);e("#estimate_using_stamina").text(i(R)),S=R-b,D=0===S?"diff-eq":S>0?"diff-plus":"diff-minus",M=(S>=0?"+":"")+i(S),e("#estimate_using_stamina_diff").attr("class",D).text(M);var A=t+Math.ceil(o.expectation*O);e("#estimate_result_collection").text(i(A)),S=A-n,D=0===S?"diff-eq":S>0?"diff-plus":"diff-minus",M=(S>=0?"+":"")+i(S),e("#estimate_result_collection_diff").attr("class",D).text(M)}function d(e){return 27+(100>=e?3*e:300+e-100)}function f(e){return 12+(100>=e?0:Math.floor((e-100)/20)+1)}n(10);var m=[["2015/06/11 15:00:00","2015/06/18 10:00:00"],["2015/06/18 15:00:00","2015/06/25 10:00:00"]].map(function(e){return e.map(Date.parse)}),v="achievement",g=1/0,y=1500,b=20,_=!0,x="mithril-timer",w=3,E=100,C="both",N=!0,D="stamina",k="direct",T=!0,O={25:"セラが仲間になる",50:"スキルレベル2",100:"初期レベル10",150:"スキルレベル3",200:"出撃コスト-1",250:"スキルレベル4",300:"出撃コスト-2",400:"スキルレベル5",500:"初期レベル20",600:"スキルレベル6",700:"出撃コスト-3",800:"スキルレベル7",900:"初期レベル30",1000:"スキルレベル8",1100:"出撃コスト-4",1200:"初期レベル40",1300:"スキルレベル9",1400:"出撃コスト-5",1500:"スキルレベル10",1600:"初期レベル50"},S=[],I=[{name:"ミスリルの洞窟",charisma:20,stamina:1,expectation:0,drops:[{name:"ミスリル鉱1",icon:"mithril-1",set:1}]},{name:"硬質の魔物",charisma:30,stamina:2,expectation:0,drops:[{name:"ミスリル鉱1",icon:"mithril-1",set:3},{name:"ハリッサ",icon:"harissa"},{name:"魔水晶1",icon:"demon-crystal-1"}]},{name:"ミスリル争奪戦",charisma:40,stamina:4,expectation:0,drops:[{name:"ミスリル鉱3",icon:"mithril-3",set:2},{name:"ミスリル鉱1",icon:"mithril-1",set:1},{name:"モーティマ",icon:"motima"},{name:"花束",icon:"flower"}]},{name:"交錯する陣容",charisma:50,stamina:7,expectation:11,drops:[{name:"ミスリル鉱3",icon:"mithril-3",set:3},{name:"ミスリル鉱1",icon:"mithril-1",set:2},{name:"カズハ",icon:"kazuha"},{name:"魔水晶2",icon:"demon-crystal-2"}]},{name:"怒涛の炎獣",charisma:80,stamina:9,expectation:0,drops:[{name:"ミスリル鉱5",icon:"mithril-5",set:4},{name:"フドウ",icon:"fudou"},{name:"白バケツ",icon:"platinum-bucket"},{name:"極上酒",icon:"hq-liquor"}]},{name:"痺れる毒針",charisma:40,stamina:5,expectation:0,drops:[{name:"ミスリル鉱3",icon:"mithril-3",set:2},{name:"ミスリル鉱1",icon:"mithril-1",set:1},{name:"カズハ",icon:"rosalie"},{name:"白精霊",icon:"platinum-sprit"}]},{name:"目覚まし機甲兵",charisma:70,stamina:8,expectation:0,drops:[{name:"ミスリル鉱5",icon:"mithril-5",set:2},{name:"ミスリル鉱3",icon:"mithril-3",set:2},{name:"アリサ",icon:"arisa"},{name:"ルビー",icon:"ruby"}]},{name:"魔の決戦兵器",charisma:90,stamina:12,expectation:0,drops:[{name:"ミスリル鉱5",icon:"mithril-5",set:4},{name:"ミスリル鉱3",icon:"mithril-3",set:2},{name:"虹精霊",icon:"rainbow-sprit"}]},{name:"妖精郷の決戦",charisma:100,stamina:2,expectation:0,drops:[{name:"金精霊",icon:"gold-sprit"},{name:"白精霊",icon:"platinum-sprit"},{name:"黒精霊",icon:"black-sprit"},{name:"虹精霊",icon:"rainbow-sprit"}]}],M=[{amount:45,unit:"gold-bucket"},{amount:90,unit:"gold-sprit"},{amount:135,unit:"platinum-bucket"},{amount:180,unit:"gold-sprit"},{amount:225,unit:"crystal-fragment"},{amount:270,unit:"platinum-sprit"},{amount:315,unit:"gold-bucket"},{amount:360,unit:"platinum-sprit"},{amount:405,unit:"platinum-bucket"},{amount:450,unit:"black-sprit"},{amount:495,unit:"crystal-fragment"},{amount:540,unit:"black-sprit"},{amount:585,unit:"gold-bucket"},{amount:630,unit:"rainbow-sprit"},{amount:675,unit:"platinum-bucket"},{amount:720,unit:"platinum-sprit"},{amount:765,unit:"crystal-fragment"},{amount:810,unit:"platinum-sprit"},{amount:855,unit:"gold-bucket"},{amount:900,unit:"black-sprit"},{amount:945,unit:"platinum-bucket"},{amount:990,unit:"platinum-sprit"},{amount:1035,unit:"crystal-fragment"},{amount:1080,unit:"platinum-sprit"},{amount:1125,unit:"gold-bucket"},{amount:1170,unit:"black-sprit"},{amount:1215,unit:"platinum-bucket"},{amount:1260,unit:"black-sprit"},{amount:1305,unit:"crystal-fragment"},{amount:1350,unit:"rainbow-sprit"},{amount:1395,unit:"gold-bucket"},{amount:1440,unit:"platinum-sprit"},{amount:1485,unit:"platinum-bucket"},{amount:1530,unit:"platinum-sprit"},{amount:1575,unit:"crystal-fragment"},{amount:1620,unit:"black-sprit"},{amount:1665,unit:"gold-bucket"},{amount:1710,unit:"black-sprit"},{amount:1755,unit:"platinum-bucket"},{amount:1800,unit:"rainbow-sprit"}],P=m.reduce(function(e,t){return e+t[1]-t[0]},0);e(function(){r(),setInterval(t,1e3)})}).call(t,n(1))}]);