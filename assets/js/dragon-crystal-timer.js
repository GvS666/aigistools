webpackJsonp([2],[function(t,e,i){(function(t){"use strict";function e(){var e=parseInt(t("[name=current]:input").val()),i=parseInt(t("[name=objective]:input").val()),n=(new Date).getTime(),o=f.reduce(function(t,e){return t+Math.max(e[1],n)-Math.max(e[0],n)},0),a=Math.max(i-e,0),r=o/864e5,l=a/Math.max(r,1),h=o/36e5,c=a/Math.max(h,1),u=o/18e5,d=a/Math.max(u,1),p=s(l,3).split(".");t("#norma_per_day").find(".norma-amount-actual").text(p[0]).parent().find(".norma-amount-fraction").text("."+p[1]).parent(),p=s(c,3).split("."),t("#norma_per_hour").find(".norma-amount-actual").text(p[0]).parent().find(".norma-amount-fraction").text("."+p[1]).parent(),p=s(d,3).split("."),t("#norma_per_minute").find(".norma-amount-actual").text(p[0]).parent().find(".norma-amount-fraction").text("."+p[1]).parent(),t("#remains_days").text(s(r,0)),t("#remains_hours").text(s(h,0)),t("#remains_minutes").text(s(60*h,0));var m,g=100*Math.min(e,i),v=parseInt(g/i)||0,b=E-o,_=parseInt(100*b/E)||0;m=100==v?"progress-bar-success":v>=_?"progress-bar-success":v>.7*_?"progress-bar-info":v>.4*_?"progress-bar-warning":"progress-bar-danger",t("#objective_progress > .progress-bar").width(v+"%").removeClass("progress-bar-success progress-bar-info progress-bar-danger progress-bar-warning").addClass(m).children("span").text(v+"%達成"),t("#period_progress > .progress-bar").width(_+"%").children("span").text(_+"%経過");var y=e*E/b;t("#prediction_collection").text(s(Math.floor(y)));var w=Math.min(y/i,1),x=t("#objective_progress").width(),k=x*w-47;t(".pointer").css("left",k+"px");var C=230>x-k?-250:0;t(".pointer-label").css("margin-left",C+"px");var T="";if(i>e&&y>=i){var S,D;f.forEach(function(t){S=S||t[0],D=D||t[1]});var I=i/y*E,M=f.reduce(function(t,e){if(t)return t;var i=e[1]-e[0];return I>i?(I-=i,null):new Date(e[0]+I)},null),P=M.getMonth(),A=M.getDate(),N=M.getHours(),z=M.getMinutes(),O=P+1+"/"+A+" "+(10>N?"0"+N:N)+":"+(10>z?"0"+z:z);T=O+"頃に目標達成できそうよ。"}t("#prediction_completion_date").text(T)}function s(t,e){return e=e||0,t===1/0||t===-(1/0)?"∞":t.toFixed(e)}function n(){var e=(new Date).getTime(),i=t("#period_dates");if(f.forEach(function(s){var n=s[1]-s[0],o=100*n/E+"%",a=new Date(s[0]),r=new Date(s[1]-1),l=a.getMonth()+1+"/"+a.getDate()+"-"+(r.getMonth()+1)+"/"+r.getDate(),h=e>=s[0]&&e<s[1],c=e>=s[1],u=h?"progress-bar-active":c?"progress-bar-expired":"progress-bar-remain";t('<div class="progress-bar">').width(o).text(l).addClass(u).appendTo(i)}),t('[data-objective-mode="'+m+'"]').show(),t('[data-objective-mode][data-objective-mode!="'+m+'"]').remove(),t("[name=current]:input").click(function(){this.select()}).TouchSpin({min:0,max:g,step:1}),"achievement"==m){var s=t("[name=objective]:input");t.each(T,function(e,i){t("<option />").attr("value",e).text(i+" ("+e+"個)").appendTo(s)})}else{t("select[name=objective]").click(function(){this.select()});var n=t("#increse_objective_list");S.forEach(function(e){t('<button class="btn btn-default" name="add"  type="button" />').val(e.value).attr("title",e.name).append(t('<i class="fa fa-arrow-up" />')).append(t("<span />").addClass("icon icon-"+e.unit)).appendTo(n)})}t("button[name=add]").click(function(e){e.preventDefault();var i=parseInt(t(this).val()),s=parseInt(t("[name=objective]:input").val());t("[name=objective]:input").val(s+i).trigger("change")}),t("button[name=reset]").click(function(e){e.preventDefault(),t("[name=objective]:input").val(0).trigger("change")}),t("[name=expectation]:input").change(function(){h(),c()}).val("drop");var v=t("#prize_list");S.forEach(function(e){t('<div class="prize-list" />').append(t('<h4 class="prize-list-header" />').text(e.name).append(t('<span class="prize-value" />').text("@"+e.value))).append(t('<div class="prize-list-body" />').attr("data-prize",e.unit)).appendTo(v)});var b=D.reduce(function(t,e){return Math.max(t,e.drops.length)},0),y=t("#map tbody");if(D.forEach(function(e,i){var s=t("<td />").attr("data-chart",i).append(t('<span class="barchart" />')).append(t('<span class="barchart-label" />')).append(t('<span class="marathon" />'));t("<tr />").append(t("<th />").text(e.name)).append(t("<td />").text(""+e.charisma+"/"+e.stamina)).append(function(){for(var i=e.drops.map(function(e){var i=e.icon?t("<i />").attr("title",e.name).addClass("icon icon-"+e.icon):t("<span />").text(e.name),s=e.set?t('<span class="badge" />').text("x"+e.set):null;return t("<td />").append(i).append(s)}),s=e.drops.length;b>s;s++)i.push(t("<td />"));return i}).append(s).appendTo(y)}),t("#map thead th.drops").attr("colspan",b),_){var w=t("#rewards tbody");I.forEach(function(e){t("<tr />").attr("data-amount",e.amount).append(t('<td class="text-right" />').html('<span class="diff"></span> '+e.amount)).append(t("<td />").html('<span class="icon icon-'+e.unit+'"></span>')).appendTo(w)})}var x=t("[name=estimate_map]:input").change(function(){u(),O.estimateMap=parseInt(t(this).val()),a(O)});D.forEach(function(e,i){t("<option />").val(i).text(e.name+" ("+e.charisma+"/"+e.stamina+")").appendTo(x)});for(var k=t("[name=estimate_rank]:input").change(function(){u(),O.estimateRank=parseInt(t(this).val()),a(O)}),C=1;200>=C;C++){var M=d(C),P=p(C),A=""+C+" ("+M+"/"+P+")";t("<option />").val(C).text(A).appendTo(k)}var N=t("[name=estimate_use_crystal]").change(function(){u(),O.estimateUseCrystal=t(this).val(),a(O)}),z=t("[name=estimate_natural_recovery]:input").change(function(){u(),O.estimateNaturalRecovery=this.checked,a(O)});t("*[title]").tooltip();var O=o();t("[name=current]:input").val(O.current),"exchange"==m?t("[name=objective]:input").val(O.objective):t("[name=objective]:input").val([O.objective]),t("[name=current]:input, [name=objective]:input").change(function(){O[this.name]=t(this).val(),a(O),r(),l(),c(),u()}),x.val(O.estimateMap),k.val(O.estimateRank),N.val(O.estimateUseCrystal),z.prop("checked",O.estimateNaturalRecovery),"exchange"==m&&l(),_&&r(),h(),c(),u()}function o(){var e={},i={current:b,objective:v,estimateMap:w,estimateRank:x,estimateUseCrystal:k,estimateNaturalRecovery:C};try{e=JSON.parse(t.cookie(y))}catch(s){}return t.extend(i,e)}function a(e){t.cookie(y,JSON.stringify(e),{expires:30})}function r(){if(_){var e=45,i=7,s=parseInt(t("[name=current]:input").val()),n=t("#rewards tbody");n.find("tr").removeClass("active").each(function(){var n=t(this),o=n.attr("data-amount")-s;if(-e>o)n.hide();else if(0>o)n.css("opacity",.5).show();else if(e>o)n.addClass("active").css("opacity",1).show();else if(e*i>o){var a=1-Math.floor(o/e)*e/(e*(i+1));n.show().css("opacity",a)}else n.hide();var r=0===o?"diff-eq":o>0?"diff-plus":"diff-minus",l=0===o?"":(o>0?"+":"")+o;n.find("span.diff").removeClass("diff-eq diff-plus diff-minus").addClass(r).text(l)})}}function l(){if("exchange"==m){var e=parseInt(t("[name=current]:input").val());S.forEach(function(i){for(var s=t('[data-prize="'+i.unit+'"]').empty(),n=0;e>n;n+=i.value){var o=t("<i />").addClass("icon icon-"+i.unit),a=25*Math.min(e-n,i.value)/i.value;t('<div class="prize-gage" />').append(o.clone().css({position:"absolute",opacity:.2,boxShadow:"none",paddingRight:25-a})).append(o.clone().css({width:a+"px"})).appendTo(s)}})}}function h(){var e=t("[name=expectation]:input").val(),i=1/0,n=0,o="drop"==e?null:e,a=D.map(function(t){var e=t.expectation/(o&&t[o]||1);return i=0,n=Math.max(n,e),e}),r=o?3:2;D.forEach(function(e,o){var l=t("[data-chart="+o+"]"),h=a[o],c=h/(n-i),u=120*c+240;l.find("span.barchart-label").text(s(h,r)+"個"),l.find("span.barchart").css({width:100*c+"%",backgroundColor:"hsla("+u+", 80%, 50%, 0.5)"})})}function c(){var e=parseInt(t("[name=objective]:input").val()),i=parseInt(t("[name=current]:input").val()),n=Math.max(e-i,0);D.forEach(function(e,i){var o=t("[data-chart="+i+"]"),a=n?Math.ceil(n/e.expectation):0;o.find("span.marathon").text("残り"+s(a)+"周")})}function u(){var e=parseInt(t("[name=current]:input").val()),i=parseInt(t("[name=objective]:input").val()),s=D[parseInt(t("[name=estimate_map]:input").val())],n=Math.max(i-e,0),o=Math.ceil(n/s.expectation);t("#estimate_required_marathon").text(o);var a=(new Date).getTime(),r=f.reduce(function(t,e){return t+Math.max(e[1],a)-Math.max(e[0],a)},0),l=0+t("[name=estimate_natural_recovery]:input").prop("checked"),h=Math.floor(r/18e4)*l,c=Math.floor(r/36e5)*l,u=parseInt(t("[name=estimate_rank]").val()),m=d(u),g=p(u),v=Math.ceil(s.charisma*o),b=Math.ceil(s.stamina*o),_=t("[name=estimate_use_crystal]:input").val(),y=0+("both"===_||"charisma"===_),w=0+("both"===_||"stamina"===_),x=Math.ceil(Math.max(v-h,0)/m)*y,k=Math.ceil(Math.max(b-c,0)/g)*w,C=x+k;t("#estimate_required_crystal").text(C);var T=0===x?"diff-eq":x>0?"diff-plus":"diff-minus";t("#estimate_required_crystal_for_charisma").attr("class",T).text(x),T=0===k?"diff-eq":k>0?"diff-plus":"diff-minus",t("#estimate_required_crystal_for_stamina").attr("class",T).text(k);var S=h+m*x,I=c+g*k,E=Math.floor(Math.min(S/s.charisma,I/s.stamina,o));t("#estimate_available_marathon").text(E);var M=E-o;T=0===M?"diff-eq":M>0?"diff-plus":"diff-minus";var P=(M>=0?"+":"")+M;t("#estimate_available_marathon_diff").attr("class",T).text(P);var A=s.charisma*E;t("#estimate_using_charisma").text(A),M=A-v,T=0===M?"diff-eq":M>0?"diff-plus":"diff-minus",P=(M>=0?"+":"")+M,t("#estimate_using_charisma_diff").attr("class",T).text(P);var N=Math.ceil(s.stamina*E);t("#estimate_using_stamina").text(N),M=N-b,T=0===M?"diff-eq":M>0?"diff-plus":"diff-minus",P=(M>=0?"+":"")+M,t("#estimate_using_stamina_diff").attr("class",T).text(P);var z=e+Math.ceil(s.expectation*E);t("#estimate_result_collection").text(z),M=z-i,T=0===M?"diff-eq":M>0?"diff-plus":"diff-minus",P=(M>=0?"+":"")+M,t("#estimate_result_collection_diff").attr("class",T).text(P)}function d(t){return 27+(100>=t?3*t:300+t-100)}function p(t){return 12+(100>=t?0:Math.floor((t-100)/20)+1)}i(10);var f=[["2015/02/14 00:00:00","2015/02/16 00:00:00"],["2015/02/21 00:00:00","2015/02/23 00:00:00"],["2015/02/28 00:00:00","2015/03/02 00:00:00"],["2015/03/07 00:00:00","2015/03/09 00:00:00"]].map(function(t){return t.map(Date.parse)}),m="exchange",g=1/0,v=300,b=20,_=!0,y="dragon-crystal-timer",w=0,x=100,k="both",C=!0,T={},S=[{value:70,unit:"aria",name:"アリア",limit:1/0},{value:300,unit:"drania",name:"ドラニア",limit:1/0}],D=[{name:"竜人の王",charisma:40,stamina:3,expectation:3.96,drops:[{name:"ダイヤ",icon:"diamond"},{name:"ウィルフレッド",icon:"will"},{name:"白銀精霊",icon:"platinum-sprit"},{name:"エレイン",icon:"elain"},{name:"刻水晶2",icon:"time-crystal-2",set:3}]},{name:"大侵攻3",charisma:40,stamina:3,expectation:3.84,drops:[{name:"ダイヤ",icon:"diamond",set:2},{name:"ラセル",icon:"lassell"},{name:"金精霊",icon:"gold-sprit"},{name:"グレイブ",icon:"grave"},{name:"刻水晶2",icon:"time-crystal-2",set:2}]},{name:"大侵攻2",charisma:35,stamina:3,expectation:3.66,drops:[{name:"ダイヤ",icon:"diamond"},{name:"レオ",icon:"leo"},{name:"金精霊",icon:"gold-sprit"},{name:"セシリー",icon:"cecily"},{name:"刻水晶2",icon:"time-crystal-2",set:3}]},{name:"大侵攻1",charisma:35,stamina:3,expectation:3,drops:[{name:"ルビー",icon:"ruby"},{name:"ロイ",icon:"roy"},{name:"銀精霊",icon:"silver-sprit"},{name:"ソーマ",icon:"soma"},{name:"刻水晶1",icon:"time-crystal-1",set:3}]},{name:"ドラゴニュート",charisma:35,stamina:3,expectation:2.43,drops:[{name:"ルビー",icon:"ruby"},{name:"ミーシャ",icon:"misha"},{name:"銀精霊",icon:"silver-sprit"},{name:"ベルナール",icon:"bell"},{name:"刻水晶1",icon:"time-crystal-1",set:3}]},{name:"竜を呼ぶ者",charisma:30,stamina:3,expectation:2.43,drops:[{name:"水晶",icon:"crystal"},{name:"ヘクター",icon:"hector"},{name:"銅精霊",icon:"bronze-sprit"},{name:"フィリス",icon:"philis"},{name:"刻水晶1",icon:"time-crystal-1",set:3}]},{name:"地底からの侵略",charisma:25,stamina:2,expectation:1.42,drops:[{name:"水晶",icon:"crystal"},{name:"バーガン",icon:"bagan"},{name:"銅精霊",icon:"bronze-sprit"},{name:"モーティマ",icon:"motima"},{name:"刻水晶1",icon:"time-crystal-1",set:2}]},{name:"大地の大穴",charisma:20,stamina:2,expectation:.71,drops:[{name:"花束",icon:"arus"},{name:"アルス",icon:"arus"},{name:"鉄精霊",icon:"iron-sprit"},{name:"ハリッサ",icon:"harissa"},{name:"刻水晶1",icon:"time-crystal-1"}]}],I=[],E=f.reduce(function(t,e){return t+e[1]-e[0]},0);t(function(){n(),setInterval(e,1e3)})}).call(e,i(2))}]);