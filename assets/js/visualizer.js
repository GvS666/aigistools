webpackJsonp([9],{0:function(t,e,i){(function(t,e){"use strict";function n(){t("#loading").show();var i=new Database(Aigis.settings.databaseUrl),n=Aigis.tables.length,s=!1,o=function(){return s?void t("#loading").hide():void(--n||e([function(){a()},function(){var e=T(),i=g();c(i,e,function(){t("#loading").hide()},function(e){P(e,"danger"),t("#loading").hide()})}]))};Aigis.tables.forEach(function(t){i.query(t,function(e){Aigis.data[t]=e,o()},function(e){s=!0,P("Unable to load "+t+" data from database. "+e.toString(),"danger"),o()})})}function a(){t.map(Aigis.data.Settings,function(t){Aigis.settings[t.key]=JSON.parse(t.value)}),Aigis.settings.infomation.forEach(function(t){P(t)}),Aigis.settings.debug&&(Aigis.data.DefaultUnit=Aigis.debugUnits);var i=location.hash.substring(1)||"damage";Aigis.state.currentGraph=i;var n=location.search.substring(1);S();var a=H(n);a.length?a.forEach(function(t){D(t)}):Aigis.settings.defaultUnits.forEach(function(t){var e=M(t.unitId);e.level=t.unitLevel||1,e.skillLevel=t.skillLevel||1,e.intimacy=0,D(e)});var s={},o=["","","CC","覚醒"],r=t.map(Aigis.data.Unit,function(t){return{id:t.id,weight:t.weight}});r.sort(function(t,e){return t.weight-e.weight}),r.forEach(function(e){var i,n=Aigis.data.Unit[e.id],a=Aigis.data.Class[n.classId];a.id in s||(i=t("<optgroup />").attr("label",a.name),s[a.id]=i),i=s[a.id];var r=o[n.classChange]+n.name;t("<option />").val(n.id).text(r).appendTo(i)}),r=t.map(Aigis.data.Class,function(t){return{id:t.id,weight:t.weight}}),r.sort(function(t,e){return t.weight-e.weight});var l=t("#unitList select[name=new_unit]");t("<option />").appendTo(l),r.forEach(function(t){var e=s[t.id];e&&e.appendTo(l)}),l.select2({placeholder:"ユニットを選択して下さい",closeOnSelect:!1,formatResult:function(t){if(!t.id)return t.text;var e=Aigis.data.Unit[t.id],i="background-position: -"+e.iconSX+"px -"+e.iconSY+"px;background-image: url("+Aigis.settings.sprite+");",n='<i class="small-icon" style="'+i+'"></i> ',a=1==e.baseHealth||1==e.potentialHealth?' <span class="label label-sm label-warning">ステータス未入力</span>':"";return n+t.text+a}}).change(function(){var e=t(this),i=M(e.val());D(i),e.select2("val",null)}),t("#unitList button[name=clear]").click(function(t){t.preventDefault(),S()}),t("button[name=refresh]").click(function(e){e.preventDefault();var i=t(this);i.attr("disabled",!0),t("#loading").show(),t("#notices").empty();var n=T(),a=g();c(a,n,function(){i.attr("disabled",!1),t("#loading").hide()},function(e){P(e,"danger"),i.attr("disabled",!1),t("#loading").hide()})}),t("input[name=target_defence], input[name=target_resistance], input[name=target_health]").TouchSpin({min:0,max:99999}),t("input[name=starting_time]").TouchSpin({min:0,max:600}),t("input[name=ending_time]").TouchSpin({min:1,max:600}),t("button[name=clearDamagePickup]").click(function(){Aigis.damageChart.setSelection(),k()}),t("button[name=clearRecoveryPickup]").click(function(){Aigis.recoveryChart.setSelection(),A()}),t("button[name=clearScorePickup]").click(function(){Aigis.scoreChart.setSelection(),_()}),t("button[name=clearCostPickup]").click(function(){Aigis.costChart.setSelection(),C()}),t("input[name=rank]").TouchSpin({min:1,max:200});var u=t("select[name=prince_title]");t.map(Aigis.data.PrinceTitle,function(e){t("<option />").val(e.id).text(e.name).appendTo(u)}),u.val(Aigis.settings.defaultPriceTitle),t("#switch a[data-toggle=tab]").on("show.bs.tab",function(t){}).on("shown.bs.tab",function(i){if(Aigis.state.result){var n=t(this).attr("data-graph");Aigis.state.currentGraph=n,e([function(){h()}]);var a="#"+n;history.replaceState&&history.replaceState(null,null,a)}});var p=Aigis.state.currentGraph;t("#switch a[data-toggle=tab][data-graph="+p+"]").tab("show"),t("#downloadDamageChart").click(function(){window.open(Aigis.damageChart.getImageURI(),"_blank")}),t("#downloadRecoveryChart").click(function(){window.open(Aigis.recoveryChart.getImageURI(),"_blank")}),t("#downloadScoreChart").click(function(){window.open(Aigis.scoreChart.getImageURI(),"_blank")}),t("#downloadCostChart").click(function(){window.open(Aigis.costChart.getImageURI(),"_blank")}),t("#url").click(function(t){t.preventDefault(),this.select()}),r=t.map(Aigis.data.Unit,function(t){return{id:t.id,weight:t.weight}}),r.sort(function(t,e){return t.weight-e.weight});var d=t("select[name=template_enemy]");r.forEach(function(e){var i=Aigis.data.Unit[e.id];i.enemy&&t("<option />").val(i.id).text(i.name).appendTo(d)});var f=N(n);E(f),d.select2().change(function(){var e=t(this);I(Aigis.data.Unit[e.val()])}).trigger("change"),t("#unitList tbody").sortable({})}function s(t,e){return e=e||2,t=t==1/0||t==-(1/0)?"∞":(t/1e3).toFixed(e),t+"秒"}function o(t,e){var i=[],n=t.map(function(t,i){var n=new Unit;return n.group=2,n.name="#"+(i+1),n.health=e.targetHealth,n.defence=e.targetDefence,n.resistance=e.targetResistance,n.rarity=Aigis.data.Rarity[2],n.actions.attack=new NullAttack(n),n.actions.heal=new NullHeal(n),n.actions.skill=new NullSkill(n,1),n.ability=new NullAbility(n),t.group=1,t.target=n,n}),a=t.concat(n),s=null,o=t.some(function(t){return s=t,"1"==t.base.id});e.princeOnField&&!o&&(s=r(),a=a.concat(s)),a.forEach(function(t,n){t.actions.attack.callbacks.warmup=function(t){this.execute(t);var e=this.owner.target,n=e.calcDamage(this.owner,e),a=this.name+" ダメージ:"+n;i.push({type:"anotation",time:t,object:this.owner,message:a}),e.damaged(n,this.owner,t)},t.callbacks.damaged=function(t,e,n,a,s){if(i.push({type:"damage",time:t,object:n,damage:e}),this.damage>=this.status.health){i.push({type:"destroy",time:t,object:n});var o="攻撃対象"+this.name+"を撃破 最大HP:"+this.status.health+" 合計ダメージ:"+this.damage;i.push({type:"anotation",time:t,object:n,message:o}),this.damage=0,n.dispatch("destroyed",this,t)}},t.actions.heal.callbacks.warmup=function(e){this.execute(e);var n=t,a=n.calcRecovery(this.owner,n),s=this.name+" 対象:"+n.name+" 回復量:"+a;i.push({type:"anotation",time:e,object:this.owner,message:s}),n.recover(a,t,e)},t.callbacks.recovered=function(t,e,n,a,s){i.push({type:"recovery",time:t,object:this,from:n,recovery:e});var o="HPが回復 "+e;i.push({type:"anotation",time:t,object:this,message:o})},e.useSkill&&(t.actions.skill.callbacks.warmup=function(t){var e=(this.getDuration(),"スキル "+this.name+" を発動 Lv:"+this.level);i.push({type:"anotation",time:t,object:this.owner,message:e}),this.execute(t)}),t.callbacks.effectAdded=function(t,e){var n=e.name+" の効果が発生 "+e.dump();i.push({type:"anotation",time:t,object:this,message:n})},t.callbacks.effectRemoved=function(t,e){var n=e.name+" の効果が終了 "+e.dump();i.push({type:"anotation",time:t,object:this,message:n})},t.ability.callbacks.started=function(t,e){var n="アビリティ "+t.name+" を発動";i.push({type:"anotation",time:e,object:t.owner,message:n})}});var l=new Stage;l.callbacks.costChanged=function(t,e,n,a,s){i.push({type:"cost",time:t,object:n,from:n,cost:e});var o="コスト変動 "+(0>=e?"":"+")+e+" (Σ"+s+") ユニット:"+n.name;i.push({type:"anotation",time:t,object:this,message:o})},l.condition=e,a.forEach(function(t){l.addUnit(t)}),l.start(),l.units.forEach(function(t){t.ability.start(0)}),l.units.forEach(function(t){1==t.group&&l.addCost(-t.cost,t,0)});for(var h=e.startingTime;h<=e.endingTime;h+=e.resolution)l.update(h);return l.stop(),i}function r(){var t=new Unit,e=Aigis.data.Unit[Aigis.settings.princeId];t.base=e,t.rarity=Aigis.data.Rarity[e.rarityId],t["class"]=Aigis.data.Class[e.classId],t.name="ダミー王子",t.actions.attack=new NullAttack(t),t.actions.heal=new NullHeal(t);var i=Aigis.data.Skill[e.skillId],n=JSON.parse(i.parameters),a=new window[i.type](t,1,n);a.name=i.name,a.warmupTime=0,t.actions.skill=a,i=Aigis.data.Ability[e.abilityId];var s=new window[i.type](t);return s.name=i.name,s.parameters=JSON.parse(i.parameters),t.ability=s,t}function e(t,i){setTimeout(function(){var n=t.shift();n.apply(i),t.length&&e(t,i)})}function l(){t("#url").val(B())}function h(){var t=Aigis.state.currentGraph;if(!Aigis.cache.graph[t])switch(Aigis.cache.graph[t]=!0,t){case"damage":p(Aigis.state.result,Aigis.state.attackers,Aigis.state.condition);break;case"recovery":d(Aigis.state.result,Aigis.state.attackers,Aigis.state.condition);break;case"score":f(Aigis.state.result,Aigis.state.attackers,Aigis.state.condition);break;case"log":x(Aigis.state.result,Aigis.state.attackers,Aigis.state.condition);break;case"cost":m(Aigis.state.result,Aigis.state.attackers,Aigis.state.condition)}l()}function c(t,i,n,a){return 0===t.length?void a("比較対象がありません。ユニットを追加して下さい。"):(Aigis.state.attackers=t,Aigis.state.condition=i,Aigis.state.result=null,Aigis.cache.graph={},void e([function(){Aigis.state.result=o(Aigis.state.attackers,Aigis.state.condition)},function(){h()},function(){n()}]))}function u(t){return{line:{"class":google.visualization.LineChart,options:{}},area:{"class":google.visualization.AreaChart,options:{}},stack:{"class":google.visualization.SteppedAreaChart,options:{isStacked:!0}}}[t]}function p(e,i,n){var a=v(e,i,n);if(Aigis.damageChartData=a,Aigis.damageChartUnits=i,0===a.getNumberOfRows())return void P("表示可能なデータがありません。","warning");var o=document.getElementById("damageChart"),r=u(n.chartType),l=new r["class"](o);google.visualization.events.addListener(l,"select",function(){k()}),Aigis.damageChart=l;var h=new google.visualization.DataView(a),c=Array.apply(null,new Array(a.getNumberOfColumns())).map(function(t,e){return e});c[0]={calc:function(t,e){return s(t.getValue(e,0),1)},type:"string"},h.setColumns(c);var p="ダメージ量 攻撃対象 防御力:"+n.targetDefence,d={title:p,hAxis:{title:"経過時間 (秒)",viewWindow:{min:0}},vAxis:{viewWindow:{min:0}},focusTarget:"category",selectionMode:"multiple",width:t("#graph").width(),height:n.height},f=t.extend({},r.options,d);l.draw(h,f),l.setSelection([{row:a.getNumberOfRows()-1,column:null}]),setTimeout(k)}function d(e,i,n){var a=y(e,i,n);if(Aigis.recoveryChartData=a,Aigis.recoveryChartUnits=i,0===a.getNumberOfRows())return void P("表示可能なデータがありません。","warning");var o=document.getElementById("recoveryChart"),r=u(n.chartType),l=new r["class"](o);google.visualization.events.addListener(l,"select",function(){A()}),Aigis.recoveryChart=l;var h=new google.visualization.DataView(a),c=Array.apply(null,new Array(a.getNumberOfColumns())).map(function(t,e){return e});c[0]={calc:function(t,e){return s(t.getValue(e,0),1)},type:"string"},h.setColumns(c);var p="回復量",d={title:p,hAxis:{title:"経過時間 (秒)",viewWindow:{min:0}},vAxis:{viewWindow:{min:0}},focusTarget:"category",selectionMode:"multiple",width:t("#graph").width(),height:n.height},f=t.extend({},r.options,d);l.draw(h,f),l.setSelection([{row:a.getNumberOfRows()-1,column:null}]),setTimeout(A)}function f(e,i,n){var a=b(e,i,n);if(Aigis.scoreChartData=a,Aigis.scoreChartUnits=i,0===a.getNumberOfRows())return void P("表示可能なデータがありません。","warning");var o=document.getElementById("scoreChart"),r=u(n.chartType),l=new r["class"](o);google.visualization.events.addListener(l,"select",function(){_()}),Aigis.scoreChart=l;var h=new google.visualization.DataView(a),c=Array.apply(null,new Array(a.getNumberOfColumns())).map(function(t,e){return e});c[0]={calc:function(t,e){return s(t.getValue(e,0),1)},type:"string"},h.setColumns(c);var p="撃破数 攻撃対象 HP:"+n.targetHealth+" 防御力:"+n.targetDefence,d={title:p,hAxis:{title:"経過時間 (秒)",viewWindow:{min:0}},vAxis:{viewWindow:{min:0}},focusTarget:"category",selectionMode:"multiple",width:t("#graph").width(),height:n.height},f=t.extend({},r.options,d);l.draw(h,f),l.setSelection([{row:a.getNumberOfRows()-1,column:null}]),setTimeout(_)}function m(e,i,n){var a=w(e,i,n);if(Aigis.costChartData=a,Aigis.costChartUnits=i,0===a.getNumberOfRows())return void P("表示可能なデータがありません。","warning");var o=document.getElementById("costChart"),r=u(n.chartType),l=new r["class"](o);google.visualization.events.addListener(l,"select",function(){C()}),Aigis.costChart=l;var h=new google.visualization.DataView(a),c=Array.apply(null,new Array(a.getNumberOfColumns())).map(function(t,e){return e});c[0]={calc:function(t,e){return s(t.getValue(e,0),1)},type:"string"},h.setColumns(c);var p="出撃コスト回復量 攻撃対象 防御力:"+n.targetDefence+" HP:"+n.targetHealth,d=-i.reduce(function(t,e){return Math.max(t,e.cost)},0);d=r.options.isStacked?0:d;var f={title:p,hAxis:{title:"経過時間 (秒)",viewWindow:{min:0}},vAxis:{baseline:d},focusTarget:"category",selectionMode:"multiple",width:t("#graph").width(),height:n.height},m=t.extend({},r.options,f);l.draw(h,m),l.setSelection([{row:a.getNumberOfRows()-1,column:null}]),setTimeout(C)}function g(){var e=[],i=t("#unitList");return i.children("tbody").children("tr[data-id]").each(function(){var i=new Unit(e.length),n=t(this);i.base=Aigis.data.Unit[n.attr("data-unit-id")],i.name=n.find("input[name=name]").val(),i["class"]=Aigis.data.Class[n.find("*[name=class]").val()],i.rarity=Aigis.data.Rarity[n.find("*[name=rarity]").val()],i.level=parseInt(n.find("select[name=level]").val()),i.health=parseInt(n.find("input[name=health]").val()),i.strength=parseInt(n.find("input[name=strength]").val()),i.defence=parseInt(n.find("input[name=defence]").val()),i.attackTimes=i.base.attackTimes;var a=0,s=Math.round(1e3*parseFloat(n.find("input[name=attack-cooldown-time]").val())),o=Aigis.data.Attack[i["class"].attackId],r=new window[o.type](i,a,s);r.name=o.name,i.actions.attack=r,o=Aigis.data.Heal[i["class"].healId];var l=new window[o.type](i,a,s);l.name=o.name,i.actions.heal=l,o=Aigis.data.Skill[n.find("*[name=skill]").val()];var h=parseInt(n.find("*[name=skill_lv]").val()),c=h?window[o.type]||NullSkill:NullSkill,u=JSON.parse(o.parameters),p=new c(i,h,u);p.name=o.name,i.actions.skill=p,o=Aigis.data.Ability[n.find("*[name=ability]").val()],c=window[o.type]||NullAbility;var d=new c(i);d.name=o.name,d.parameters=JSON.parse(o.parameters),i.ability=d,i.attackEnabled=i["class"].attackEnabled,i.healEnabled=i["class"].healEnabled,i.cost=i.base.minCost,e.push(i)}),e}function v(t,e,i){var n=new google.visualization.DataTable;n.addColumn("number","経過時間"),e.forEach(function(t){n.addColumn("number",t.name)}),n.addColumn({type:"string",role:"anotation"}),n.addColumn({type:"string",role:"anotationText"});for(var a=e.map(function(){return 0}),s=0,o=1,r=o+e.length,l=i.startingTime;l<=i.endingTime;l+=100){for(var h=[l].concat(a,"",""),c=t[s];c&&c.time<=l;c=t[s]){switch(c.type){case"anotation":h[r]="!",h[r+1]+=c.message+"\n";break;case"damage":a[c.object.id]+=c.damage,h[o+c.object.id]+=c.damage}s++}n.addRow(h)}return n}function y(t,e,i){var n=new google.visualization.DataTable;n.addColumn("number","経過時間"),e.forEach(function(t){n.addColumn("number",t.name)}),n.addColumn({type:"string",role:"anotation"}),n.addColumn({type:"string",role:"anotationText"});for(var a=e.map(function(){return 0}),s=0,o=1,r=o+e.length,l=i.startingTime;l<=i.endingTime;l+=100){for(var h=[l].concat(a,"",""),c=t[s];c&&c.time<=l;c=t[s]){switch(c.type){case"anotation":h[r]="!",h[r+1]+=c.message+"\n";break;case"recovery":a[c.object.id]+=c.recovery,h[o+c.object.id]+=c.recovery}s++}n.addRow(h)}return n}function b(t,e,i){var n=new google.visualization.DataTable;n.addColumn("number","経過時間"),e.forEach(function(t){n.addColumn("number",t.name)}),n.addColumn({type:"string",role:"anotation"}),n.addColumn({type:"string",role:"anotationText"});for(var a=e.map(function(){return 0}),s=0,o=1,r=o+e.length,l=i.startingTime;l<=i.endingTime;l+=100){for(var h=[l].concat(a,"",""),c=t[s];c&&c.time<=l;c=t[s]){switch(c.type){case"anotation":h[r]="!",h[r+1]+=c.message+"\n";break;case"destroy":a[c.object.id]++,h[o+c.object.id]++}s++}n.addRow(h)}return n}function w(t,e,i){var n=new google.visualization.DataTable;n.addColumn("number","経過時間"),e.forEach(function(t){n.addColumn("number",t.name)}),n.addColumn({type:"string",role:"anotation"}),n.addColumn({type:"string",role:"anotationText"});for(var a=e.map(function(){return 0}),s=0,o=1,r=o+e.length,l=i.startingTime;l<=i.endingTime;l+=100){for(var h=[l].concat(a,"",""),c=t[s];c&&c.time<=l;c=t[s]){switch(c.type){case"anotation":h[r]="!",h[r+1]+=c.message+"\n";break;case"cost":a[c.object.id]+=c.cost,h[o+c.object.id]+=c.cost}s++}n.addRow(h)}return n}function x(e){var i=t("#logGraph .table-log tbody");i.empty(),e.forEach(function(e){switch(e.type){case"anotation":t("<tr />").append(t('<td class="time" />').text(s(e.time))).append(t("<td />").text(e.object.name)).append(t("<td />").text(e.message)).appendTo(i)}})}function k(){for(var e=Aigis.damageChartData,i=Aigis.damageChartUnits,n=t("#damagePickup"),a=[],o=0;o<1+i.length;o++)a[o]=t("<tr />");t("<th />").text("経過時間 / ダメージ").appendTo(a[0]),i.forEach(function(e,i){t("<td />").text(e.name).appendTo(a[1+i])});var r=t("<tbody />"),l=Aigis.damageChart.getSelection(),h=l.map(function(t){return{index:t.row,time:e.getValue(t.row,0)}});h.sort(function(t,e){return t.index-e.index}),h.forEach(function(n){var o=n.index,r=e.getValue(o,0);t("<th />").text(s(r,1)).appendTo(a[0]),i.forEach(function(i,n){t("<td />").text(e.getValue(o,1+n)).appendTo(a[1+n])})}),r=n.children("tbody").empty(),a.forEach(function(t){t.appendTo(r)})}function A(){for(var e=Aigis.recoveryChartData,i=Aigis.recoveryChartUnits,n=t("#recoveryPickup"),a=[],o=0;o<1+i.length;o++)a[o]=t("<tr />");t("<th />").text("経過時間 / 回復量").appendTo(a[0]),i.forEach(function(e,i){t("<td />").text(e.name).appendTo(a[1+i])});var r=t("<tbody />"),l=Aigis.recoveryChart.getSelection(),h=l.map(function(t){return{index:t.row,time:e.getValue(t.row,0)}});h.sort(function(t,e){return t.index-e.index}),h.forEach(function(n){var o=n.index,r=e.getValue(o,0);t("<th />").text(s(r,1)).appendTo(a[0]),i.forEach(function(i,n){t("<td />").text(e.getValue(o,1+n)).appendTo(a[1+n])})}),r=n.children("tbody").empty(),a.forEach(function(t){t.appendTo(r)})}function _(){for(var e=Aigis.scoreChartData,i=Aigis.scoreChartUnits,n=t("#scorePickup"),a=[],o=0;o<1+i.length;o++)a[o]=t("<tr />");t("<th />").text("経過時間 / 撃破数").appendTo(a[0]),i.forEach(function(e,i){t("<td />").text(e.name).appendTo(a[1+i])});var r=t("<tbody />"),l=Aigis.scoreChart.getSelection(),h=l.map(function(t){return{index:t.row,time:e.getValue(t.row,0)}});h.sort(function(t,e){return t.index-e.index}),h.forEach(function(n){var o=n.index,r=e.getValue(o,0);t("<th />").text(s(r,1)).appendTo(a[0]),i.forEach(function(i,n){t("<td />").text(e.getValue(o,1+n)).appendTo(a[1+n])})}),r=n.children("tbody").empty(),a.forEach(function(t){t.appendTo(r)})}function C(){for(var e=Aigis.costChartData,i=Aigis.costChartUnits,n=t("#costPickup"),a=[],o=0;o<1+i.length;o++)a[o]=t("<tr />");t("<th />").text("経過時間 / 回復量").appendTo(a[0]),i.forEach(function(e,i){t("<td />").text(e.name).appendTo(a[1+i])});var r=t("<tbody />"),l=Aigis.costChart.getSelection(),h=l.map(function(t){return{index:t.row,time:e.getValue(t.row,0)}});h.sort(function(t,e){return t.index-e.index}),h.forEach(function(n){var o=n.index,r=e.getValue(o,0);t("<th />").text(s(r,1)).appendTo(a[0]),i.forEach(function(i,n){t("<td />").text(e.getValue(o,1+n)).appendTo(a[1+n])})}),r=n.children("tbody").empty(),a.forEach(function(t){t.appendTo(r)})}function S(){t("#unitList").data("sequence",0).children("tbody").empty()}function D(e){var i=t("#unitList"),n=i.data("sequence"),a=n++,s=e.base;i.data("sequence",n);var o=t("<tr />").attr("data-id",a).attr("data-unit-id",e.id).attr("data-rarity",e.rarity.id),r=t("<input />").attr("type","text").attr("name","name").attr("value",e.name).attr("class","form-control").attr("data-id",a);t('<td class="unit-name" />').append(r).appendTo(o),t('<i class="small-icon" />').css({backgroundImage:"url("+Aigis.settings.sprite+")",backgroundPosition:"-"+s.iconSX+"px -"+s.iconSY+"px"}).wrap('<td class="unit-icon" />').parent().appendTo(o);var l,h,c=t('<td class="unit-info" />').appendTo(o);e.base.editable?(l=t("<select />").attr("name","rarity").attr("class","form-control").attr("data-id",a),t.map(Aigis.data.Rarity,function(e){t("<option />").val(e.id).text(e.name).appendTo(l)}),l.val(e.rarity.id).appendTo(c),h=t("<select />").attr("name","class").attr("class","form-control").attr("data-id",a),t.map(Aigis.data.Class,function(i){t("<option />").val(i.id).text(i.name).appendTo(h),h.val(e["class"].id).appendTo(c)})):(l=t('<input type="hidden" />').attr("name","rarity").attr("data-id",a).val(e.rarity.id).appendTo(c),h=t('<input type="hidden" />').attr("name","class").attr("data-id",a).val(e["class"].id).appendTo(c),t("<span />").addClass("label label-rarity-"+e.rarity.id).text(e.rarity.name).appendTo(c),t("<span />").addClass("label label-class").text(e["class"].name).appendTo(c));for(var u=t("<select />").attr("name","level").attr("class","form-control").attr("data-id",a),p=e.base.minLevel;p<=e.base.maxLevel;p++)t("<option />").val(p).text(p).appendTo(u);u.val(e.level),t('<td class="unit-lv" />').append(u).appendTo(o);var d=t("<select />").attr("name","intimacy").attr("class","form-control").attr("data-id",a);for(p=0;p<=e.base.maxIntimacy;p++)t("<option />").val(p).text(p+"%").appendTo(d);d.val(e.intimacy||0).attr("readonly",0===e.base.maxIntimacy),t('<td class="unit-imtimacy" />').append(d).appendTo(o);var f=t("<input />").attr("type","text").attr("name","strength").attr("value",e.strength).attr("class","form-control").attr("data-id",a);t('<td class="unit-strength" />').append(f).appendTo(o);var m=t("<input />").attr("type","text").attr("name","attack-cooldown-time").attr("value",e.attackCooldownTime/1e3).attr("class","form-control text-sm").attr("data-id",a);t('<td class="unit-attack-cooldown-time" />').append(m).appendTo(o),c=t('<td class="unit-ability" />').appendTo(o);var g,v,y=e.skill;if(e.base.editable)g=t("<select />").attr("name","skill").attr("class","form-control").attr("data-id",a).attr("readonly",!e.base.editable),t.map(Aigis.data.Skill,function(e){t("<option />").val(e.id).text(e.name).appendTo(g)}),g.val(e.skill.id).appendTo(c),v=t("<select />").attr("name","skill_lv").attr("class","form-control").attr("data-id",a).appendTo(c);else{t('<input type="hidden" />').attr("name","skill").attr("data-id",a).val(y.id).appendTo(c),t('<input type="hidden" />').attr("name","skill_lv").attr("data-id",a).val(e.skillLevel).appendTo(c);var b=t('<ul class="dropdown-menu" role="menu"></ul>');for(t('<a href="#" />').attr("data-level",0).text("使用しない").wrap("<li>").parent().appendTo(b),p=y.minLevel;p<=y.maxLevel;p++)t('<a href="#" />').attr("data-level",p).text("Lv"+p).wrap("<li>").parent().appendTo(b);t('<div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="skill-label"></span> <span class="skill-level"></span> <span class="caret"></span></button></div>').append(b).on("click","a",function(e){e.preventDefault();var i=parseInt(t(this).attr("data-level"));t("input[name=skill_lv][data-id="+a+"]").val(i);var n=i?"Lv"+i:'<i class="glyphicon glyphicon-remove"></i>';t("tr[data-id="+a+"] .skill-level").html(n)}).appendTo(c).find(".skill-label").text(y.name).parent().find(".skill-level").text("Lv"+e.skillLevel)}c=t('<td class="unit-ability" />').appendTo(o);var w;w=t("<select />").attr("name","ability").attr("class","form-control").attr("data-id",a),t.map(Aigis.data.Ability,function(e){t("<option />").val(e.id).text(e.name).appendTo(w)}),w.val(e.ability.id).appendTo(c).select2();var x=t('<input type="hidden" />').attr("name","health").val(e.health),k=t('<input type="hidden" />').attr("name","defence").val(e.defence),A=t("<button />").attr("name","remove").attr("class","btn btn-warning btn-xs").attr("data-id",a).html('<span class="glyphicon glyphicon-remove"></span> 削除').click(function(e){e.preventDefault(),t(this).closest("tr").remove()});t('<td class="command" />').append(A).append(x).append(k).appendTo(o),o.appendTo(i.children("tbody")),f.TouchSpin({min:0,max:99999}),m.TouchSpin({min:.01,max:60,decimals:2,step:.01}),e.base.editable&&(g.select2().change(function(){var e=Aigis.data.Skill[t(this).val()];v.empty().attr("readonly",e.minLevel==e.maxLevel);for(var i=e.minLevel;i<=e.maxLevel;i++)t("<option />").val(i).text(i).appendTo(v);v.val(e.minLevel)}).trigger("change"),v.val(e.skillLevel||1)),t([u.get(0),d.get(0)]).change(function(){var e=parseInt(u.val())-s.minLevel,i=s.maxLevel-s.minLevel,n=Math.min(parseInt(d.val())||0,100)/100;n=1==n?1.2:n;var a=parseInt(t("input[name=rank]").val()),o=s.id!=Aigis.settings.princeId||100>=a?0:Math.floor((a-100)/25),r=Math.round((s.potentialHealth-s.baseHealth)*e/i),l=Math.round(s.bonusHealth*n),h=100*o,c=s.baseHealth+r+l+h;x.val(c),r=Math.round((s.potentialStrength-s.baseStrength)*e/i),l=Math.round(s.bonusStrength*n),h=10*o;var p=s.baseStrength+r+l+h;f.val(p),r=Math.round((s.potentialDefence-s.baseDefence)*e/i),l=Math.round(s.bonusDefence*n),h=10*o;var m=s.baseDefence+r+l+h;k.val(m)}).trigger("change")}function T(){return{startingTime:1e3*parseInt(t("input[name=starting_time]").val()),endingTime:1e3*parseInt(t("input[name=ending_time]").val()),resolution:1,targetDefence:parseInt(t("input[name=target_defence]").val()),targetHealth:parseInt(t("input[name=target_health]").val()),targetResistance:parseInt(t("input[name=target_resistance]").val()),rank:parseInt(t("input[name=rank]").val()),princeTitle:Aigis.data.PrinceTitle[t("select[name=prince_title]").val()],princeOnField:!!t("input[name=prince_on_field]:checked").val(),useSkill:!!t("input[name=use_skill]:checked").val(),abilityToAll:!!t("input[name=ability_to_all]:checked").val(),chartType:t("select[name=chart_type]").val(),height:parseInt(t("input[name=height]").val())}}function E(e){void 0!==e.startingTime&&t("input[name=starting_time]").val(Math.floor(e.startingTime/1e3)),void 0!==e.endingTime&&t("input[name=ending_time]").val(Math.floor(e.endingTime/1e3)),void 0!==e.resolution&&t("input[name=resolution]").val(Math.floor(e.resolution/1e3)),void 0!==e.target&&t("select[name=template_enemy]").val(e.target),void 0!==e.targetHealth&&t("input[name=target_health]").val(e.targetHealth),void 0!==e.targetDefence&&t("input[name=target_defence]").val(e.targetDefence),void 0!==e.targetResistance&&t("input[name=target_resistance]").val(e.targetResistance),void 0!==e.rank&&t("input[name=rank]").val(e.rank),void 0!==e.princeTitle&&t("select[name=prince_title]").val(e.princeTitle.id),void 0!==e.princeOnField&&t("input[name=prince_on_field]").prop("checked",e.princeOnField),void 0!==e.useSkill&&t("input[name=use_skill]").prop("checked",e.useSkill),void 0!==e.abilityToAll&&t("input[name=ability_to_all]").prop("checked",e.abilityToAll),void 0!==e.chartType&&t("select[name=chart_type]").val(e.chartType),void 0!==e.height&&t("input[name=height]").val(e.height)}function P(e,i){i=i||"info",t('<div class="alert alert-'+i+'" />').text(e).appendTo(t("#notices"))}function I(e){t("input[name=target_defence]").val(e.baseDefence),t("input[name=target_health]").val(e.baseHealth)}function M(t){var e=new Unit,i=Aigis.data.Unit[t];e.id=i.id,e.base=i;var n=["","","CC","覚醒"];return e.name=n[i.classChange]+i.name,e.level=i.maxLevel,e.health=i.baseHealth,e.strength=i.baseStrength,e.defende=i.baseDefence,e.attackTimes=i.attackTimes,e.attackWarmupTime=i.attackWarmupTime,e.attackCooldownTime=i.attackCooldownTime,e.intimacy=i.maxIntimacy,e["class"]=Aigis.data.Class[i.classId],e.skill=Aigis.data.Skill[i.skillId]||NullSkill,e.skillLevel=e.skill.maxLevel,e.rarity=Aigis.data.Rarity[i.rarityId],e.ability=Aigis.data.Ability[i.abilityId]||NullAbility,e.cost=i.minCost||0,e}function z(){var e=[];e.push(["ss",1e3*parseInt(t("input[name=starting_time]").val())]),e.push(["se",1e3*parseInt(t("input[name=ending_time]").val())]),e.push(["sr",1]),e.push(["ti",t("select[name=template_enemy]").val()]),e.push(["td",t("input[name=target_defence]").val()]),e.push(["th",t("input[name=target_health]").val()]),e.push(["tr",t("input[name=target_resistance]").val()]),e.push(["ra",t("input[name=rank]").val()]),e.push(["pt",t("select[name=prince_title]").val()]),e.push(["po",t("input[name=prince_on_field]:checked").val()?1:0]),e.push(["su",t("input[name=use_skill]:checked").val()?1:0]),e.push(["aa",t("input[name=ability_to_all]:checked").val()?1:0]),e.push(["dc",t("select[name=chart_type]").val()]),e.push(["dh",t("input[name=height]").val()]);var i=0;return t("#unitList tr[data-id]").each(function(){var n=(new Unit(i),t(this)),a="u["+i+"]";e.push([a+"[i]",n.attr("data-unit-id")]),e.push([a+"[n]",n.find("input[name=name]").val()]),e.push([a+"[c]",n.find("*[name=class]").val()]),e.push([a+"[r]",n.find("*[name=rarity]").val()]),e.push([a+"[l]",n.find("select[name=level]").val()]),e.push([a+"[m]",n.find("select[name=intimacy]").val()]),e.push([a+"[s]",n.find("input[name=strength]").val()]),e.push([a+"[o]",parseInt(Math.floor(1e3*parseFloat(n.find("input[name=attack-cooldown-time]").val())))]),e.push([a+"[k]",n.find("*[name=skill]").val()]),e.push([a+"[e]",n.find("*[name=skill_lv]").val()]),e.push([a+"[a]",n.find("*[name=ability]").val()]),i++}),e.push(["ul",i]),e.map(function(t){return t[0]+"="+encodeURIComponent(t[1])}).join("&")}function N(t){var e=t.split("&").map(function(t){return t.split("=").map(decodeURIComponent)}).reduce(function(t,e){return t[e[0]]=e[1],t},{});return{startingTime:e.ss?parseInt(e.ss):0,endingTime:e.se?parseInt(e.se):6e4,resolution:0,target:e.ti?parseInt(e.ti):1e3,targetDefence:e.td?parseInt(e.td):void 0,targetHealth:e.th?parseInt(e.th):void 0,targetResistance:e.tr?parseInt(e.tr):void 0,rank:e.ra?parseInt(e.ra):100,princeTitle:e.pt?Aigis.data.PrinceTitle[e.pt]:void 0,princeOnField:e.po?!!parseInt(e.po):!1,useSkill:e.su?!!parseInt(e.su):!0,abilityToAll:e.aa?!!parseInt(e.aa):!1,chartType:e.dc?e.dc:"area",height:e.dh?parseInt(e.dh):600}}function H(t){for(var e=[],i=t.split("&").map(function(t){return t.split("=").map(decodeURIComponent)}).reduce(function(t,e){return t[e[0]]=e[1],t},{}),n=parseInt(i.ul),a=0;n>a;a++){var s="u["+a+"]",o=i[s+"[i]"],r=M(o),l=i[s+"[n]"];l&&(r.name=l);var h=i[s+"[r]"];h&&(r.rarityId=h,r.rarity=Aigis.data.Rarity[h]);var c=i[s+"[c]"];c&&(r.classId=c,r.klass=Aigis.data.Class[c]);var u=i[s+"[l]"];u&&(r.level=parseInt(u));var p=i[s+"[s]"];p&&(r.strength=parseInt(p));var d=i[s+"[m]"];d&&(r.intimacy=parseFloat(d));var f=i[s+"[o]"];f&&(r.attackCooldownTime=parseInt(f));var m=i[s+"[k]"];m&&(r.skillId=m,r.skill=Aigis.data.Skill[m]);var g=i[s+"[e]"];g&&(r.skillLevel=parseInt(g));var v=i[s+"[a]"];v&&(r.abilityId=v,r.ability=Aigis.data.Ability[v]),e.push(r)}return e}function B(){return location.protocol+"//"+location.host+location.pathname+"?"+z()+location.hash}i(2),i(9),i(24),i(25),i(34),google.load("visualization","1",{packages:["corechart","table"]}),google.setOnLoadCallback(n)}).call(e,i(2),i(33))},33:function(t,e){function i(){h=!1,o.length?l=o.concat(l):c=-1,l.length&&n()}function n(){if(!h){var t=setTimeout(i);h=!0;for(var e=l.length;e;){for(o=l,l=[];++c<e;)o[c].run();c=-1,e=l.length}o=null,h=!1,clearTimeout(t)}}function a(t,e){this.fun=t,this.array=e}function s(){}var o,r=t.exports={},l=[],h=!1,c=-1;r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new a(t,e)),1!==l.length||h||setTimeout(n,0)},a.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=s,r.addListener=s,r.once=s,r.off=s,r.removeListener=s,r.removeAllListeners=s,r.emit=s,r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},34:function(t,e,i){(function(){"use strict";var t=i(35);window.Aigis={settings:{databaseUrl:"https://docs.google.com/spreadsheets/d/1-zStm1B36Ckq1Tpxrz018h3YVAsZyd2vustqghPFie0/edit",debug:!1},tables:["Class","Rarity","Attack","Heal","Skill","Ability","Unit","PrinceTitle","Settings"],data:{},state:{currentGraph:"damage"},cache:{}},window.Stage=function(){this.name="ステージ",this.condition=null,this.units=[],this.time=0,this.status={},this.cost=0,this.callbacks={}},Stage.prototype=Object.create({}),Stage.prototype.constructor=Object,Stage.prototype.dispatch=function(){var t=Array.prototype.slice.call(arguments),e=t.shift(),i=this.callbacks[e];i&&i.apply(this,t)},Stage.prototype.addUnit=function(t){t.stage=this,
this.units.push(t)},Stage.prototype.clearStatus=function(){var t=this.status;t.morale=0},Stage.prototype.start=function(){this.clearStatus(),this.units.forEach(function(t){t.reset()})},Stage.prototype.stop=function(){},Stage.prototype.update=function(t){this.clearStatus();for(var e,i=this.units,n=i.length,a=0;n>a;a++)e=i[a],e.ability.update(t),e.actions.skill.update(t);for(a=0;n>a;a++)i[a].updateStatus(t);for(a=0;n>a;a++)e=i[a],e.actions.attack.update(t),e.actions.heal.update(t)},Stage.prototype.addCost=function(t,e,i){var n=this.cost,a=n+t;return this.cost=a,this.dispatch("costChanged",i,t,e,n,a),t},window.Unit=function(t){this.id=t,this.group=0,this.name="",this.level=1,this.health=0,this.strength=0,this.defence=0,this.resistance=0,this.cost=0,this.attackTimes=1,this.attackWarmupDelay=1,this.attackCooldownDelay=1,this.attackAttribution=0,this.healWarmupDelay=1,this.healCooldownDelay=1,this.skillWarmupDelay=1,this.skillCooldownDelay=1,this.attackEnabled=!0,this.healEnabled=!0,this.skillEnabled=!0,this.ability=null,this.actions={},this.callbacks={},this.effects=null,this.damage=null,this.status={},this.reset(),this.clearStatus()},Unit.prototype=Object.create(Object.prototype),Unit.prototype.constructor=Object,Unit.prototype.dispatch=function(){var t=Array.prototype.slice.call(arguments),e=t.shift(),i=this.callbacks[e];i&&i.apply(this,t)},Unit.prototype.reset=function(){this.damage=0,this.effects=[];for(var t in this.actions){var e=this.actions[t];e.reset()}if(this["class"]&&window[this["class"].effect]){var i=new window[this["class"].effect](this,0,1/0,1);this.addEffect(i,0)}},Unit.prototype.clearStatus=function(){var t=this.status;t.health=this.health,t.strength=this.strength,t.defence=this.defence,t.resistance=this.resistance,t.attackWarmupDelay=this.attackWarmupDelay,t.attackCooldownDelay=this.attackCooldownDelay,t.attackTimes=this.attackTimes,t.healWarmupDelay=this.healWarmupDelay,t.healCooldownDelay=this.healCooldownDelay,t.skillWarmupDelay=this.skillWarmupDelay,t.skillCooldownDelay=this.skillCooldownDelay,t.attackEnabled=this.attackEnabled,t.healEnabled=this.healEnabled,t.skillEnabled=this.skillEnabled,t.attackAttribution=this.attackAttribution},Unit.prototype.updateStatus=function(t){this.clearStatus();for(var e=0;e<this.effects.length;e++){var i=this.effects[e];i.update(t),i.expired&&(this.effects.splice(e--,1),this.dispatch("effectRemoved",t,i))}this.actions.attack.enabled=this.status.attackEnabled,this.actions.heal.enabled=this.status.healEnabled,this.actions.skill.enabled=this.status.skillEnabled},Unit.prototype.updateActions=function(t){for(var e in this.actions){var i=this.actions[e];i.update(t)}},Unit.prototype.damaged=function(t,e,i){var n=this.damage,a=n+t;return this.damage=a,this.dispatch("damaged",i,t,e,n,a),t},Unit.prototype.calcDamage=function(t,e){return Math.floor(t.actions.attack.calcDamage(t,e))},Unit.prototype.recover=function(t,e,i){var n=this.damage,a=Math.max(n-t,0);return this.damage=a,this.dispatch("recovered",i,t,e,n,a),t},Unit.prototype.calcRecovery=function(t,e){return Math.floor(t.actions.heal.calcDamage(t,e))},Unit.prototype.addEffect=function(t,e){this.effects.push(t),this.dispatch("effectAdded",e,t)},window.Action=function(t,e,i){this.name="?",this.owner=t,this.warmupTime=e,this.cooldownTime=i,this.warmupDelay=1,this.cooldownDelay=1,this.state=0,this.baseTime=0,this.callbacks={}},Action.prototype=Object.create(Object.prototype,{executable:{configuable:!1,get:function(){return 1==this.state}}}),Action.prototype.constructor=Object,Action.prototype.reset=function(){this.state=0,this.baseTime=0,this.enabled=!0},Action.prototype.dispatch=function(){var t=Array.prototype.slice.call(arguments),e=t.shift(),i=this.callbacks[e];i&&i.apply(this,t)},Action.prototype.update=function(t){if(this.enabled)for(;;){switch(this.state){case 0:var e=this.getWarmupTime()*this.getWarmupDelay();if(t>=this.baseTime+e){this.state=1,this.baseTime=this.baseTime+this.warmupTime,this.dispatch("warmup",t);continue}break;case 1:break;case 2:this.state=3,this.baseTime=t+this.getDuration(),this.dispatch("execute",t);continue;case 3:var i=this.getCooldownTime()*this.getCooldownDelay();t>=this.baseTime+i&&(this.state=1,this.baseTime=this.baseTime+i,this.dispatch("warmup",t))}break}},Action.prototype.execute=function(t){if(!this.executable)throw new Error("Unable to execute action. current state is "+this.state);this.state=2,this.update(t)},Action.prototype.getDuration=function(){return 0},Action.prototype.getWarmupTime=function(){return this.warmupTime},Action.prototype.getCooldownTime=function(){return this.cooldownTime},Action.prototype.getWarmupDelay=function(){return this.warmupDelay},Action.prototype.getCooldownDelay=function(){return this.cooldownDelay},window.Attack=function(t,e,i){Action.call(this,t,e,i)},Attack.prototype=Object.create(Action.prototype),Attack.prototype.constructor=Action,Attack.prototype.getWarmupDelay=function(){return this.owner.status.attackWarmupDelay},Attack.prototype.getCooldownDelay=function(){return this.owner.status.attackCooldownDelay},Attack.prototype.calcDamage=function(t,e){throw new Error("Not implemented")},window.NullAttack=function(t,e,i){Attack.call(this,t,1/0,1/0)},NullAttack.prototype=Object.create(Attack.prototype),NullAttack.prototype.constructor=Attack,NullAttack.prototype.calcDamage=function(t,e){return 0},window.PhygicalAttack=function(t,e,i){Attack.call(this,t,e,i),this.magical=!1},PhygicalAttack.prototype=Object.create(Attack.prototype),PhygicalAttack.prototype.constructor=Attack,PhygicalAttack.prototype.calcDamage=function(t,e){var i=t.status,n=e.status,a=0===i.attackAttribution?n.defence:0,s=Math.floor(i.strength/10);return Math.max(i.strength-a,s,0)*i.attackTimes},window.MagicalAttack=function(t,e,i){Attack.call(this,t,e,i)},MagicalAttack.prototype=Object.create(Attack.prototype),MagicalAttack.prototype.constructor=Attack,MagicalAttack.prototype.calcDamage=function(t,e){var i=t.status,n=e.status,a=Math.max(Math.floor(i.strength*(1-n.resistance/100)),0);return a*i.attackTimes},window.MagicalSplashAttack=function(t,e,i){Attack.call(this,t,e,i)},MagicalSplashAttack.prototype=Object.create(Attack.prototype),MagicalSplashAttack.prototype.constructor=Attack,MagicalSplashAttack.prototype.calcDamage=function(t,e){var i=t.status,n=e.status;return Math.max(i.strength-n.defence,0)*i.attackTimes},window.Heal=function(t,e,i){Action.call(this,t,e,i)},Heal.prototype=Object.create(Action.prototype),Heal.prototype.constructor=Action,Heal.prototype.getWarmupDelay=function(){return this.owner.status.attackWarmupDelay},Heal.prototype.getCooldownDelay=function(){return this.owner.status.attackCooldownDelay},Heal.prototype.calcRecovery=function(t,e){throw new Error("Not implemented")},window.NullHeal=function(t,e,i){Heal.call(this,t,1/0,1/0)},NullHeal.prototype=Object.create(Heal.prototype),NullHeal.prototype.constructor=Heal,NullHeal.prototype.calcRecovery=function(t,e){return 0},window.MagicalHeal=function(t,e,i){Heal.call(this,t,e,i)},MagicalHeal.prototype=Object.create(Heal.prototype),MagicalHeal.prototype.constructor=Heal,MagicalHeal.prototype.calcDamage=function(t,e){var i=t.status;return i.strength},window.Skill=function(t,e,i){Action.call(this,t,1/0,1/0),this.level=e,this.parameters=i||this.getParamTable(),this.param=this.parameters[this.owner.rarity.id]},Skill.prototype=Object.create(Action.prototype),Skill.prototype.constructor=Action,Skill.prototype.getDuration=function(){return this.param?this.param.durationBase+this.param.durationRate*this.level:1/0},Skill.prototype.getWarmupTime=function(){return this.param?this.param.warmupBase+this.param.warmupRate*this.level:1/0},Skill.prototype.getCooldownTime=function(){return this.param?this.param.cooldownBase+this.param.cooldownRate*this.level:1/0},Skill.prototype.getMultiplier=function(){return this.param?this.param.multiplierBase+this.param.multiplierRate*this.level:1/0},Skill.prototype.getWarmupDelay=function(){return this.owner.status.skillWarmupDelay},Skill.prototype.getCooldownDelay=function(){return this.owner.status.skillCooldownDelay},Skill.prototype.getParamTable=function(){return{}},window.NullSkill=function(t,e){Skill.call(this,t,e),this.warmupTime=1/0,this.cooldownTime=1/0},NullSkill.prototype=Object.create(Skill.prototype),NullSkill.prototype.constructor=Skill,window.RaiseMoraleSkill=function(t,e){Skill.call(this,t,e)},RaiseMoraleSkill.prototype=Object.create(Skill.prototype),RaiseMoraleSkill.prototype.constructor=Skill,RaiseMoraleSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=this.owner.stage,n=i.condition.princeOnField;i.units.forEach(function(a){if(1==a.group&&(n||a.base.id==Aigis.settings.princeId)){var s=i.status.morale,o=new MoraleEffect(a,t,e,s);a.addEffect(o,t)}})},RaiseMoraleSkill.prototype.getParamTable=function(){return{1:{durationBase:1/0,durationRate:1/0,warmupBase:0,warmupRate:0,cooldownBase:1/0,cooldownRate:1/0}}},window.EnforceStrengthSkill=function(t,e,i){Skill.call(this,t,e,i)},EnforceStrengthSkill.prototype=Object.create(Skill.prototype),EnforceStrengthSkill.prototype.constructor=Skill,EnforceStrengthSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=this.getMultiplier(),n=new EnforceStrengthEffect(this.owner,t,e,i);this.owner.addEffect(n,t)},window.DesperationSkill=function(t,e){EnforceStrengthSkill.call(this,t,e)},DesperationSkill.prototype=Object.create(EnforceStrengthSkill.prototype),DesperationSkill.prototype.constructor=EnforceStrengthSkill,window.Desperation1Skill=function(t,e){DesperationSkill.call(this,t,e)},Desperation1Skill.prototype=Object.create(DesperationSkill.prototype),Desperation1Skill.prototype.constructor=DesperationSkill,Desperation1Skill.prototype.getParamTable=function(){return{4:{durationBase:1e4,durationRate:0,warmupBase:45e3,warmupRate:-1e3,cooldownBase:45e3,cooldownRate:-1e3,multiplierBase:1.375,multiplierRate:.125}}},window.Desperation2Skill=function(t,e){DesperationSkill.call(this,t,e)},Desperation2Skill.prototype=Object.create(DesperationSkill.prototype),Desperation2Skill.prototype.constructor=DesperationSkill,Desperation2Skill.prototype.getParamTable=function(){return{5:{durationBase:1e4,durationRate:0,warmupBase:27e3,warmupRate:-1e3,cooldownBase:35e3,cooldownRate:-1e3,multiplierBase:1.575,multiplierRate:.125},6:{durationBase:1e4,durationRate:0,warmupBase:21e3,warmupRate:-1e3,cooldownBase:35e3,cooldownRate:-1e3,multiplierBase:1.575,multiplierRate:.125}}},window.Desperation3Skill=function(t,e){DesperationSkill.call(this,t,e)},Desperation3Skill.prototype=Object.create(DesperationSkill.prototype),Desperation3Skill.prototype.constructor=DesperationSkill,Desperation3Skill.prototype.getParamTable=function(){return{5:{durationBase:1e4,durationRate:0,warmupBase:27e3,warmupRate:-1e3,cooldownBase:35e3,cooldownRate:-1e3,multiplierBase:1.775,multiplierRate:.125},6:{durationBase:1e4,durationRate:0,warmupBase:21e3,warmupRate:-1e3,cooldownBase:35e3,cooldownRate:-1e3,multiplierBase:1.775,multiplierRate:.125}}},window.AssassinationSkill=function(t,e){EnforceStrengthSkill.call(this,t,e)},AssassinationSkill.prototype=Object.create(EnforceStrengthSkill.prototype),AssassinationSkill.prototype.constructor=EnforceStrengthSkill,window.Assassination1Skill=function(t,e){AssassinationSkill.call(this,t,e)},Assassination1Skill.prototype=Object.create(AssassinationSkill.prototype),Assassination1Skill.prototype.constructor=AssassinationSkill,Assassination1Skill.prototype.getParamTable=function(){return{4:{durationBase:15e3,durationRate:0,warmupBase:6e4,warmupRate:-1e3,cooldownBase:6e4,cooldownRate:-1e3,multiplierBase:1,multiplierRate:.1},5:{durationBase:15e3,durationRate:0,warmupBase:41e3,warmupRate:-1e3,cooldownBase:6e4,cooldownRate:-1e3,multiplierBase:1,multiplierRate:.1}}},window.Assassination2Skill=function(t,e){AssassinationSkill.call(this,t,e)},Assassination2Skill.prototype=Object.create(AssassinationSkill.prototype),Assassination2Skill.prototype.constructor=AssassinationSkill,Assassination2Skill.prototype.getParamTable=function(){return{5:{durationBase:2e4,durationRate:0,warmupBase:23e3,warmupRate:-1e3,cooldownBase:5e4,cooldownRate:-1e3,multiplierBase:1.1,multiplierRate:.125},6:{durationBase:2e4,durationRate:0,warmupBase:2e3,warmupRate:0,cooldownBase:5e4,cooldownRate:-1e3,multiplierBase:1.1,multiplierRate:.125}}},window.Assassination3Skill=function(t,e){AssassinationSkill.call(this,t,e)},Assassination3Skill.prototype=Object.create(AssassinationSkill.prototype),Assassination3Skill.prototype.constructor=AssassinationSkill,Assassination3Skill.prototype.getParamTable=function(){return{7:{durationBase:25e3,durationRate:0,warmupBase:2e3,warmupRate:0,cooldownBase:45e3,cooldownRate:-1e3,multiplierBase:1.15,multiplierRate:.15}}},window.AroundightSkill=function(t,e){EnforceStrengthSkill.call(this,t,e)},AroundightSkill.prototype=Object.create(EnforceStrengthSkill.prototype),AroundightSkill.prototype.constructor=EnforceStrengthSkill,AroundightSkill.prototype.getParamTable=function(){return{6:{durationBase:28750,durationRate:1250,warmupBase:45e3,warmupRate:1e3,cooldownBase:9e4,cooldownRate:-1e3,multiplierBase:1.5,multiplierRate:0}}},window.FragarachSkill=function(t,e){EnforceStrengthSkill.call(this,t,e)},FragarachSkill.prototype=Object.create(EnforceStrengthSkill.prototype),FragarachSkill.prototype.constructor=EnforceStrengthSkill,FragarachSkill.prototype.getParamTable=function(){return{7:{durationBase:28e3,durationRate:2e3,warmupBase:2e3,warmupRate:0,cooldownBase:9e4,cooldownRate:-1e3,multiplierBase:1,multiplierRate:.1}}},window.TyrfingSkill=function(t,e){EnforceStrengthSkill.call(this,t,e)},TyrfingSkill.prototype=Object.create(EnforceStrengthSkill.prototype),TyrfingSkill.prototype.constructor=EnforceStrengthSkill,TyrfingSkill.prototype.getParamTable=function(){return{6:{durationBase:8e3,durationRate:1e3,warmupBase:1e4,warmupRate:-1e3,cooldownBase:24e3,cooldownRate:-1e3,multiplierBase:1.05,multiplierRate:.05},7:{durationBase:8e3,durationRate:1e3,warmupBase:2e3,warmupRate:0,cooldownBase:8e4,cooldownRate:-1e3,multiplierBase:1.05,multiplierRate:.05}}},window.ExorcismFireSkill=function(t,e){EnforceStrengthSkill.call(this,t,e)},ExorcismFireSkill.prototype=Object.create(EnforceStrengthSkill.prototype),ExorcismFireSkill.prototype.constructor=EnforceStrengthSkill,ExorcismFireSkill.prototype.getParamTable=function(){return{6:{durationBase:15e3,durationRate:0,warmupBase:23e3,warmupRate:-1e3,cooldownBase:45e3,cooldownRate:-1e3,multiplierBase:1.175,multiplierRate:.125}}},window.HolySenseSkill=function(t,e){EnforceStrengthSkill.call(this,t,e)},HolySenseSkill.prototype=Object.create(EnforceStrengthSkill.prototype),HolySenseSkill.prototype.constructor=EnforceStrengthSkill,HolySenseSkill.prototype.getParamTable=function(){return{6:{durationBase:2500,durationRate:7500,warmupBase:16e3,warmupRate:-1e3,cooldownBase:3e4,cooldownRate:-1e3,multiplierBase:2,multiplierRate:0}}},window.MultipleShotSkill=function(t,e){Skill.call(this,t,e),this.delta=0},MultipleShotSkill.prototype=Object.create(Skill.prototype),MultipleShotSkill.prototype.constructor=Skill,MultipleShotSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=new MultipleAttackEffect(this.owner,t,e,this.delta);this.owner.addEffect(i,t)},MultipleShotSkill.prototype.getParamTable=function(){throw new Error("Not implemented")},window.DoubleShotSkill=function(t,e){MultipleShotSkill.call(this,t,e),this.delta=2},DoubleShotSkill.prototype=Object.create(MultipleShotSkill.prototype),DoubleShotSkill.prototype.constructor=MultipleShotSkill,DoubleShotSkill.prototype.getParamTable=function(){return{5:{durationBase:15e3,durationRate:0,warmupBase:34e3,warmupRate:-1e3,cooldownBase:5e4,cooldownRate:-1e3},6:{durationBase:15e3,durationRate:0,warmupBase:26e3,warmupRate:-1e3,cooldownBase:5e4,cooldownRate:-1e3}}},window.TripleShotSkill=function(t,e){MultipleShotSkill.call(this,t,e),this.delta=2},TripleShotSkill.prototype=Object.create(MultipleShotSkill.prototype),TripleShotSkill.prototype.constructor=MultipleShotSkill,TripleShotSkill.prototype.getParamTable=function(){return{6:{durationBase:15e3,durationRate:0,warmupBase:22e3,warmupRate:-1e3,cooldownBase:43e3,cooldownRate:-1e3},7:{durationBase:15e3,durationRate:0,warmupBase:2e3,warmupRate:0,cooldownBase:43e3,cooldownRate:-1e3}}},window.QuadroShotSkill=function(t,e){MultipleShotSkill.call(this,t,e),this.delta=3},QuadroShotSkill.prototype=Object.create(MultipleShotSkill.prototype),QuadroShotSkill.prototype.constructor=MultipleShotSkill,QuadroShotSkill.prototype.getParamTable=function(){return{7:{durationBase:15e3,durationRate:0,warmupBase:2e3,warmupRate:0,cooldownBase:4e4,cooldownRate:-1e3}}},window.QuickShotSkill=function(t,e,i){Skill.call(this,t,e,i)},QuickShotSkill.prototype=Object.create(Skill.prototype),QuickShotSkill.prototype.constructor=Skill,QuickShotSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=this.getMultiplier(),n=new EnforceStrengthEffect(this.owner,t,e,i);this.owner.addEffect(n,t);var a=this.getDelay();n=new AttackDelayEffect(this.owner,t,e,0,1-a),this.owner.addEffect(n,t)},QuickShotSkill.prototype.getDelay=function(){return this.param?this.param.delayBase+this.param.delayRate*this.level:1/0},window.BarrageShotSkill=function(t,e,i){Skill.call(this,t,e,i)},BarrageShotSkill.prototype=Object.create(Skill.prototype),BarrageShotSkill.prototype.constructor=Skill,BarrageShotSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=this.getMultiplier(),n=new EnforceStrengthEffect(this.owner,t,e,i);this.owner.addEffect(n,t);var a=this.getDelay();n=new AttackDelayEffect(this.owner,t,e,0,1-a),this.owner.addEffect(n,t)},BarrageShotSkill.prototype.getDelay=function(){return this.param?this.param.delayBase+this.param.delayRate*this.level:1/0},window.ModeChangeSkill=function(t,e,i){Skill.call(this,t,e,i)},ModeChangeSkill.prototype=Object.create(Skill.prototype),ModeChangeSkill.prototype.constructor=Skill,ModeChangeSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=this.getDelay();effect=new AttackDelayEffect(this.owner,t,e,0,i),this.owner.addEffect(effect,t)},ModeChangeSkill.prototype.getDelay=function(){return this.param?this.param.delayBase+this.param.delayRate*this.level:1/0},window.MagicBulletSkill=function(t,e){QuickShotSkill.call(this,t,e)},MagicBulletSkill.prototype=Object.create(QuickShotSkill.prototype),MagicBulletSkill.prototype.constructor=QuickShotSkill,window.MagicBullet1Skill=function(t,e){MagicBulletSkill.call(this,t,e)},MagicBullet1Skill.prototype=Object.create(MagicBulletSkill.prototype),MagicBullet1Skill.prototype.constructor=MagicBulletSkill,MagicBullet1Skill.prototype.getParamTable=function(){return{7:{durationBase:23750,durationRate:1250,warmupBase:2e3,warmupRate:0,cooldownBase:6e4,cooldownRate:-1,multiplierBase:1,multiplierRate:.1,delayBase:.5,delayRate:0}}},window.MagicBullet2Skill=function(t,e){MagicBulletSkill.call(this,t,e)},MagicBullet2Skill.prototype=Object.create(MagicBulletSkill.prototype),MagicBullet2Skill.prototype.constructor=MagicBulletSkill,MagicBullet2Skill.prototype.getParamTable=function(){return{7:{durationBase:23750,durationRate:1250,warmupBase:2e3,warmupRate:0,cooldownBase:6e4,cooldownRate:-1e3,multiplierBase:1.075,multiplierRate:.125,delayBase:.5,delayRate:0}}},window.ExcellentAllowSkill=function(t,e,i){EnforceStrengthSkill.call(this,t,e,i)},ExcellentAllowSkill.prototype=Object.create(EnforceStrengthSkill.prototype),ExcellentAllowSkill.prototype.constructor=EnforceStrengthSkill,window.EnforceHealingSkill=function(t,e,i){EnforceStrengthSkill.call(this,t,e,i)},EnforceHealingSkill.prototype=Object.create(EnforceStrengthSkill.prototype),EnforceHealingSkill.prototype.constructor=EnforceStrengthSkill,window.EnforceHealing1Skill=function(t,e){EnforceHealingSkill.call(this,t,e)},EnforceHealing1Skill.prototype=Object.create(EnforceHealingSkill.prototype),EnforceHealing1Skill.prototype.constructor=EnforceHealingSkill,EnforceHealing1Skill.prototype.getParamTable=function(){return{4:{durationBase:18750,durationRate:1250,warmupBase:5e4,warmupRate:-1e3,cooldownBase:5e4,cooldownRate:-1e3,multiplierBase:1,multiplierRate:.1},5:{durationBase:18750,durationRate:1250,warmupBase:34e3,warmupRate:-1e3,cooldownBase:5e4,cooldownRate:-1e3,multiplierBase:1,multiplierRate:.1}}},window.EnforceHealing2Skill=function(t,e){EnforceHealingSkill.call(this,t,e)},EnforceHealing2Skill.prototype=Object.create(EnforceHealingSkill.prototype),EnforceHealing2Skill.prototype.constructor=EnforceHealingSkill,EnforceHealing2Skill.prototype.getParamTable=function(){return{5:{durationBase:24e3,durationRate:1e3,warmupBase:3e4,warmupRate:-1e3,cooldownBase:45e3,cooldownRate:-1e3,multiplierBase:1.075,multiplierRate:.125},6:{durationBase:24e3,durationRate:1e3,warmupBase:24e3,warmupRate:-1e3,cooldownBase:45e3,cooldownRate:-1e3,multiplierBase:1.075,multiplierRate:.125}}},window.EnforceHealing3Skill=function(t,e){EnforceHealingSkill.call(this,t,e)},EnforceHealing3Skill.prototype=Object.create(EnforceHealingSkill.prototype),EnforceHealing3Skill.prototype.constructor=EnforceHealingSkill,EnforceHealing3Skill.prototype.getParamTable=function(){return{6:{durationBase:29e3,durationRate:1e3,warmupBase:21e3,warmupRate:-1e3,cooldownBase:4e4,cooldownRate:-1e3,multiplierBase:1.15,multiplierRate:.15}}},window.HealingPrayerSkill=function(t,e){EnforceHealingSkill.call(this,t,e)},HealingPrayerSkill.prototype=Object.create(EnforceHealingSkill.prototype),HealingPrayerSkill.prototype.constructor=EnforceHealingSkill,HealingPrayerSkill.prototype.getParamTable=function(){return{6:{durationBase:15e3,durationRate:0,warmupBase:13e3,warmupRate:-500,cooldownBase:25e3,cooldownRate:-1e3,multiplierBase:1.175,multiplierRate:.125}}},window.StarWandSkill=function(t,e){EnforceHealingSkill.call(this,t,e)},StarWandSkill.prototype=Object.create(EnforceHealingSkill.prototype),StarWandSkill.prototype.constructor=EnforceHealingSkill,StarWandSkill.prototype.getParamTable=function(){return{6:{durationBase:29e3,durationRate:1e3,warmupBase:21e3,warmupRate:-1e3,cooldownBase:4e4,cooldownRate:-1e3,multiplierBase:1.15,multiplierRate:.05}}},window.HealingMagicSkill=function(t,e,i){Skill.call(this,t,e,i)},HealingMagicSkill.prototype=Object.create(Skill.prototype),HealingMagicSkill.prototype.constructor=Skill,HealingMagicSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=new SwitchHealerEffect(this.owner,t,e);this.owner.addEffect(i,t);var n=this.getMultiplier();i=new EnforceStrengthEffect(this.owner,t,e,n),this.owner.addEffect(i,t)},window.Effect=function(t,e,i){this.name="?",this.owner=t,this.startTime=e,this.duration=i,this.priority=0,this.expired=!1,this.callbacks={}},Effect.prototype=Object.create(Object.prototype,{}),Effect.prototype.constructor=Object,Effect.prototype.dispatch=function(){var t=Array.prototype.slice.call(arguments),e=t.shift(),i=this.callbacks[e];i&&i.apply(this,t)},Effect.prototype.update=function(t){(this.expired||t-this.startTime>this.duration)&&this.expire(t)},Effect.prototype.expire=function(t){this.expired=!0,this.dispatch("expire")},Effect.prototype.dump=function(){return"?"},window.MoraleEffect=function(t,e,i,n){Effect.call(this,t,e,i),this.name="士気高揚",this.rate=n},MoraleEffect.prototype=Object.create(Effect.prototype,{}),MoraleEffect.prototype.constructor=Effect,MoraleEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired||(this.owner.status.strength*=this.rate,this.owner.status.defence*=this.rate)},MoraleEffect.prototype.dump=function(){var e=Math.floor(100*this.rate)+"%";return" 攻撃力補正:"+e+" 防御力補正:"+e+" 効果時間:"+t(this.duration)},window.EnforceStrengthEffect=function(t,e,i,n){Effect.call(this,t,e,i),this.name="攻撃力強化",this.multiplier=n},EnforceStrengthEffect.prototype=Object.create(Effect.prototype,{}),EnforceStrengthEffect.prototype.constructor=Effect,EnforceStrengthEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired||(this.owner.status.strength*=this.multiplier)},EnforceStrengthEffect.prototype.dump=function(){return"攻撃力補正:"+(100*this.multiplier).toFixed(1)+"% 効果時間:"+t(this.duration)},window.EnforceHealthEffect=function(t,e,i,n){Effect.call(this,t,e,i),this.name="最大HP強化",this.multiplier=n},EnforceHealthEffect.prototype=Object.create(Effect.prototype,{}),EnforceHealthEffect.prototype.constructor=Effect,EnforceHealthEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired||(this.owner.status.health*=this.multiplier)},EnforceHealthEffect.prototype.dump=function(){return"最大HP補正:"+(100*this.multiplier).toFixed(1)+"% 効果時間:"+t(this.duration)},window.EnforceDefenceEffect=function(t,e,i,n){Effect.call(this,t,e,i),this.name="防御力強化",this.multiplier=n},EnforceDefenceEffect.prototype=Object.create(Effect.prototype,{}),EnforceDefenceEffect.prototype.constructor=Effect,EnforceDefenceEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired||(this.owner.status.defence*=this.multiplier)},EnforceDefenceEffect.prototype.dump=function(){return"防御力補正:"+(100*this.multiplier).toFixed(1)+"% 効果時間:"+t(this.duration)},window.AttackDelayEffect=function(t,e,i,n,a){Effect.call(this,t,e,i),this.name="攻撃速度変化",this.warmupDelay=n||1,this.cooldownDelay=a||1},AttackDelayEffect.prototype=Object.create(Effect.prototype,{}),AttackDelayEffect.prototype.constructor=Effect,AttackDelayEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired||(this.owner.status.attackWarmupDelay*=this.warmupDelay,this.owner.status.attackCooldownDelay*=this.cooldownDelay)},AttackDelayEffect.prototype.dump=function(){return"攻撃ディレイ補正:"+100*this.cooldownDelay+"% 効果時間:"+t(this.duration)},window.MultipleAttackEffect=function(t,e,i,n){Effect.call(this,t,e,i),this.name="攻撃回数変化",this.delta=n},MultipleAttackEffect.prototype=Object.create(Effect.prototype,{}),MultipleAttackEffect.prototype.constructor=Effect,MultipleAttackEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired||(this.owner.status.attackTimes+=this.delta)},MultipleAttackEffect.prototype.dump=function(){return"攻撃回数:"+(this.delta>0?"+":"")+this.delta+"回 効果時間:"+t(this.duration)},window.SelfHealingSkill=function(t,e){Skill.call(this,t,e)},SelfHealingSkill.prototype=Object.create(Skill.prototype),SelfHealingSkill.prototype.constructor=Skill,SelfHealingSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getMultiplier(),i=new SelfHealingEffect(this.owner,t,1/0,e);this.owner.addEffect(i,t)},SelfHealingSkill.prototype.getParamTable=function(){throw new Error("Not implemented")},window.SelfHealing1Skill=function(t,e){SelfHealingSkill.call(this,t,e)},SelfHealing1Skill.prototype=Object.create(SelfHealingSkill.prototype),SelfHealing1Skill.prototype.constructor=SelfHealingSkill,SelfHealing1Skill.prototype.getParamTable=function(){return{4:{durationBase:0,durationRate:0,warmupBase:4e4,warmupRate:-1e3,cooldownBase:4e4,cooldownRate:-1e3,multiplierBase:.2,multiplierRate:.01}}},window.SelfHealing2Skill=function(t,e){SelfHealingSkill.call(this,t,e)},SelfHealing2Skill.prototype=Object.create(SelfHealingSkill.prototype),SelfHealing2Skill.prototype.constructor=SelfHealingSkill,SelfHealing2Skill.prototype.getParamTable=function(){return{5:{durationBase:0,durationRate:0,warmupBase:31e3,warmupRate:-1e3,cooldownBase:4e4,cooldownRate:-1e3,multiplierBase:.3,multiplierRate:.01}}},window.SelfHealing3Skill=function(t,e){SelfHealingSkill.call(this,t,e)},SelfHealing3Skill.prototype=Object.create(SelfHealingSkill.prototype),SelfHealing3Skill.prototype.constructor=SelfHealingSkill,SelfHealing3Skill.prototype.getParamTable=function(){return{5:{durationBase:0,durationRate:0,warmupBase:3e4,warmupRate:-1e3,cooldownBase:5e4,cooldownRate:-1e3,multiplierBase:.4,multiplierRate:.01},6:{durationBase:0,durationRate:0,warmupBase:3e4,warmupRate:0,cooldownBase:5e4,cooldownRate:-1e3,multiplierBase:.4,multiplierRate:.01}}},window.SelfHealing4Skill=function(t,e){SelfHealingSkill.call(this,t,e)},SelfHealing4Skill.prototype=Object.create(SelfHealingSkill.prototype),SelfHealing4Skill.prototype.constructor=SelfHealingSkill,SelfHealing4Skill.prototype.getParamTable=function(){return{7:{durationBase:0,durationRate:0,warmupBase:2e3,warmupRate:0,cooldownBase:55e3,cooldownRate:-1e3,multiplierBase:.5,multiplierRate:.01}}},window.SelfHealingEffect=function(t,e,i,n){Effect.call(this,t,e,i),this.name="自己回復",this.multiplier=n},SelfHealingEffect.prototype=Object.create(Effect.prototype,{}),SelfHealingEffect.prototype.constructor=Effect,SelfHealingEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired||(this.owner.recover(this.calcRecovery(),this,t),this.expired=!0)},SelfHealingEffect.prototype.dump=function(){return"回復量:"+this.calcRecovery()+" 対象最大HP:"+this.owner.status.health+" 回復率:"+(100*this.multiplier).toFixed(1)+"%"},SelfHealingEffect.prototype.calcRecovery=function(){return Math.floor(this.owner.status.health*this.multiplier)},window.HealingPrayerSkill=function(t,e){Skill.call(this,t,e)},HealingPrayerSkill.prototype=Object.create(Skill.prototype),HealingPrayerSkill.prototype.constructor=Skill,HealingPrayerSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=new SwitchHealerEffect(this.owner,t,e);this.owner.addEffect(i,t);var n=this.getMultiplier();i=new EnforceStrengthEffect(this.owner,t,e,n),this.owner.addEffect(i,t)},HealingPrayerSkill.prototype.getParamTable=function(){return{6:{durationBase:15e3,durationRate:0,warmupBase:13e3,warmupRate:-500,cooldownBase:25e3,cooldownRate:-1e3,multiplierBase:1.175,multiplierRate:.125}}},window.SwitchAttackerEffect=function(t,e,i){Effect.call(this,t,e,i),this.name="攻撃モード";var n=this.owner.actions.attack,a=this.owner.actions.heal;n.baseTime=a.baseTime,n.state=a.state},SwitchAttackerEffect.prototype=Object.create(Effect.prototype,{}),SwitchAttackerEffect.prototype.constructor=Effect,SwitchAttackerEffect.prototype.update=function(t){if(Effect.prototype.update.call(this,t),this.expired){var e=this.owner.actions.attack,i=this.owner.actions.heal;return i.baseTime=e.baseTime,void(i.state=e.state)}this.owner.status.attackEnabled=!0,this.owner.status.healEnabled=!1},SwitchAttackerEffect.prototype.dump=function(){return"効果時間:"+t(this.duration)},window.SwitchHealerEffect=function(t,e,i){Effect.call(this,t,e,i),this.name="回復モード";var n=this.owner.actions.attack,a=this.owner.actions.heal;a.baseTime=n.baseTime,a.state=n.state},SwitchHealerEffect.prototype=Object.create(Effect.prototype,{}),SwitchHealerEffect.prototype.constructor=Effect,SwitchHealerEffect.prototype.update=function(t){if(Effect.prototype.update.call(this,t),this.expired){var e=this.owner.actions.attack,i=this.owner.actions.heal;return e.baseTime=i.baseTime,void(e.state=i.state)}this.owner.status.attackEnabled=!1,this.owner.status.healEnabled=!0},SwitchHealerEffect.prototype.dump=function(){return"効果時間:"+t(this.duration)},window.MagicalSwordSkill=function(t,e,i){Skill.call(this,t,e,i)},MagicalSwordSkill.prototype=Object.create(Skill.prototype),MagicalSwordSkill.prototype.constructor=Skill,MagicalSwordSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=this.getMultiplier(),n=new EnforceStrengthEffect(this.owner,t,e,i);this.owner.addEffect(n,t),n=new EnchantAttributionEffect(this.owner,t,e,1),this.owner.addEffect(n,t)},window.SwordEnhanceSkill=function(t,e,i){Skill.call(this,t,e,i)},SwordEnhanceSkill.prototype=Object.create(Skill.prototype),SwordEnhanceSkill.prototype.constructor=Skill,SwordEnhanceSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=this.getMultiplier(),n=new EnforceStrengthEffect(this.owner,t,e,i);this.owner.addEffect(n,t),n=new EnchantAttributionEffect(this.owner,t,e,1),this.owner.addEffect(n,t);
},window.EnchantAttributionEffect=function(t,e,i,n){Effect.call(this,t,e,i),this.name="属性付与",this.attribution=n},EnchantAttributionEffect.prototype=Object.create(Effect.prototype,{}),EnchantAttributionEffect.prototype.constructor=Effect,EnchantAttributionEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired||(this.owner.status.attackAttribution=this.attribution)},EnchantAttributionEffect.prototype.dump=function(){var e="準魔法";return"効果時間:"+t(this.duration)+" 属性:"+e},window.ExorcismFireSkill=function(t,e){Skill.call(this,t,e)},ExorcismFireSkill.prototype=Object.create(Skill.prototype),ExorcismFireSkill.prototype.constructor=Skill,ExorcismFireSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=new SwitchAttackerEffect(this.owner,t,e);this.owner.addEffect(i,t);var n=this.getMultiplier();i=new EnforceStrengthEffect(this.owner,t,e,n),this.owner.addEffect(i,t)},ExorcismFireSkill.prototype.getParamTable=function(){return{6:{durationBase:15e3,durationRate:0,warmupBase:23e3,warmupRate:-500,cooldownBase:45e3,cooldownRate:-1e3,multiplierBase:1.175,multiplierRate:.125}}},window.MuramasaSkill=function(t,e){Skill.call(this,t,e)},MuramasaSkill.prototype=Object.create(Skill.prototype),MuramasaSkill.prototype.constructor=Skill,MuramasaSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=this.getMultiplier(),n=new DrainEffect(this.owner,t,e,i);this.owner.addEffect(n,t)},MuramasaSkill.prototype.getParamTable=function(){return{6:{durationBase:1e4,durationRate:0,warmupBase:16e3,warmupRate:-500,cooldownBase:25e3,cooldownRate:-1e3,multiplierBase:0,multiplierRate:.03}}},window.DrainEffect=function(t,e,i,n){Effect.call(this,t,e,i),this.name="攻撃時回復",this.multiplier=n;var a=this;this.owner.actions.attack.callbacks.execute=function(t){a.owner.recover(a.calcRecovery(),a.owner,t)}},DrainEffect.prototype=Object.create(Effect.prototype,{}),DrainEffect.prototype.constructor=Effect,DrainEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired&&delete this.owner.actions.attack.callbacks.execute},DrainEffect.prototype.dump=function(){return"回復量:"+this.calcRecovery()+" 対象最大HP:"+this.owner.status.health+" 回復率:"+(100*this.multiplier).toFixed(1)+"%"},DrainEffect.prototype.calcRecovery=function(){return Math.floor(this.owner.status.health*this.multiplier)},window.FlameFormationSkill=function(t,e){EnforceStrengthSkill.call(this,t,e)},FlameFormationSkill.prototype=Object.create(EnforceStrengthSkill.prototype),FlameFormationSkill.prototype.constructor=EnforceStrengthSkill,FlameFormationSkill.prototype.getParamTable=function(){return{6:{durationBase:8750,durationRate:1250,warmupBase:45e3,warmupRate:0,cooldownBase:9e4,cooldownRate:0,multiplierBase:1.075,multiplierRate:.025}}},window.RushSkill=function(t,e){Skill.call(this,t,e)},RushSkill.prototype=Object.create(Skill.prototype),RushSkill.prototype.constructor=Skill,RushSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=this.getDelay(),n=new AttackDelayEffect(this.owner,t,e,0,1-i);this.owner.addEffect(n,t)},RushSkill.prototype.getDelay=function(){return this.param?this.param.delayBase+this.param.delayRate*this.level:1/0},RushSkill.prototype.getParamTable=function(){return{5:{durationBase:7500,durationRate:2500,warmupBase:24e3,warmupRate:-1e3,cooldownBase:35e3,cooldownRate:-1e3,delayBase:.5,delayRate:0}}},window.IfritSkill=function(t,e){Skill.call(this,t,e)},IfritSkill.prototype=Object.create(Skill.prototype),IfritSkill.prototype.constructor=Skill,IfritSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=new EnableAttackEffect(this.owner,t,e);this.owner.addEffect(i,t)},IfritSkill.prototype.getParamTable=function(){return{6:{durationBase:5e3,durationRate:5e3,warmupBase:12400,warmupRate:-400,cooldownBase:26e3,cooldownRate:-1e3}}},window.BreakSealSkill=function(t,e,i){Skill.call(this,t,e,i)},BreakSealSkill.prototype=Object.create(Skill.prototype),BreakSealSkill.prototype.constructor=Skill,BreakSealSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=new EnableAttackEffect(this.owner,t,e);this.owner.addEffect(i,t)},window.EnableAttackEffect=function(t,e,i){Effect.call(this,t,e,i),this.name="攻撃有効化"},EnableAttackEffect.prototype=Object.create(Effect.prototype,{}),EnableAttackEffect.prototype.constructor=Effect,EnableAttackEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired||(this.owner.status.attackEnabled=!0)},EnableAttackEffect.prototype.dump=function(){return"効果時間:"+t(this.duration)},window.MagicEnhanceSkill=function(t,e){EnforceStrengthSkill.call(this,t,e)},MagicEnhanceSkill.prototype=Object.create(EnforceStrengthSkill.prototype),MagicEnhanceSkill.prototype.constructor=EnforceStrengthSkill,MagicEnhanceSkill.prototype.getParamTable=function(){return{4:{durationBase:35e3,durationRate:5e3,warmupBase:65e3,warmupRate:-1e3,cooldownBase:65e3,cooldownRate:-1e3,multiplierBase:1.04,multiplierRate:.06}}},window.CursedBloodSkill=function(t,e){EnforceStrengthSkill.call(this,t,e)},CursedBloodSkill.prototype=Object.create(EnforceStrengthSkill.prototype),CursedBloodSkill.prototype.constructor=EnforceStrengthSkill,CursedBloodSkill.prototype.getParamTable=function(){return{6:{durationBase:13340,durationRate:1660,warmupBase:40500,warmupRate:-500,cooldownBase:8e4,cooldownRate:-1e3,multiplierBase:1.165,multiplierRate:.035}}},window.Ability=function(t){this.name="?",this.owner=t,this.callbacks={}},Ability.prototype=Object.create(Object.prototype),Ability.prototype.constructor=Object,Ability.prototype.dispatch=function(){var t=Array.prototype.slice.call(arguments),e=t.shift(),i=this.callbacks[e];i&&i.apply(this,t)},Ability.prototype.update=function(){},Ability.prototype.start=function(t){this.dispatch("started",this,t)},window.NullAbility=function(t){Ability.call(this,t)},NullAbility.prototype=Object.create(Ability.prototype),NullAbility.prototype.constructor=Ability,NullAbility.prototype.start=function(t){},window.PrinceAbility=function(t){Ability.call(this,t)},PrinceAbility.prototype=Object.create(Ability.prototype),PrinceAbility.prototype.constructor=Ability,PrinceAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=this.owner.stage,i=e.condition.princeTitle,n=new TitleEffect(this.owner,t,1/0,i);this.owner.addEffect(n,t)},PrinceAbility.prototype.update=function(t){this.__proto__.__proto__.update.call(this,t);var e=this.owner.stage,i=this.calcMorale();e.status.morale+=i},PrinceAbility.prototype.calcMorale=function(){var t=this.owner.stage.condition,e=t.princeTitle.morale,i=t.rank;return e+Math.ceil(i/10+Math.floor(i/100)+1)/100+1},window.TitleEffect=function(t,e,i,n){Effect.call(this,t,e,i),this.name="称号効果",this.title=n},TitleEffect.prototype=Object.create(Effect.prototype,{}),TitleEffect.prototype.constructor=Effect,TitleEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired||(this.owner.status.health*=1+this.title.health,this.owner.status.strength*=1+this.title.strength,this.owner.status.defence*=1+this.title.defence)},TitleEffect.prototype.dump=function(){return" HP補正:"+(Math.floor(100*this.title.health)+100)+"% 攻撃力補正:"+(Math.floor(100*this.title.strength)+100)+"% 防御力補正:"+(Math.floor(100*this.title.defence)+100)+"% 士気値補正:"+(Math.floor(100*this.title.morale)+100)+"% 効果時間:"+t(this.duration)},window.PowerAttackAbility=function(t){Ability.call(this,t)},PowerAttackAbility.prototype=Object.create(Ability.prototype),PowerAttackAbility.prototype.constructor=Ability,PowerAttackAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=this.parameters.strength,i=new EnforceStrengthEffect(this.owner,t,1/0,e);this.owner.addEffect(i,t);var n=this.parameters.cooldownTime;i=new AttackDelayEffect(this.owner,t,1/0,1,n),this.owner.addEffect(i,t)},window.HealthBoostAbility=function(t){Ability.call(this,t)},HealthBoostAbility.prototype=Object.create(Ability.prototype),HealthBoostAbility.prototype.constructor=Ability,HealthBoostAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=this.parameters.health,i=new EnforceHealthEffect(this.owner,t,1/0,e);this.owner.addEffect(i,t)},window.TeamHealthBoostAbility=function(t){Ability.call(this,t)},TeamHealthBoostAbility.prototype=Object.create(Ability.prototype),TeamHealthBoostAbility.prototype.constructor=Ability,TeamHealthBoostAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=this.parameters.health,i=this.owner,n=this.owner.stage,a=n.condition.abilityToAll;n.units.forEach(function(n){if(1==n.group&&(a||n==i)){var s=new EnforceHealthEffect(n,t,1/0,e);n.addEffect(s,t)}})},window.QuickAttackAbility=function(t){Ability.call(this,t)},QuickAttackAbility.prototype=Object.create(Ability.prototype),QuickAttackAbility.prototype.constructor=Ability,QuickAttackAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=0,i=this.parameters.cooldownTime,n=new AttackDelayEffect(this.owner,t,1/0,e,i);this.owner.addEffect(n,t)},window.IaiAbility=function(t){Ability.call(this,t)},IaiAbility.prototype=Object.create(Ability.prototype),IaiAbility.prototype.constructor=Ability,IaiAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=0,i=this.parameters.cooldownTime,n=new AttackDelayEffect(this.owner,t,1/0,e,i);this.owner.addEffect(n,t)},window.QuickChantAbility=function(t){Ability.call(this,t)},QuickChantAbility.prototype=Object.create(Ability.prototype),QuickChantAbility.prototype.constructor=Ability,QuickChantAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=0,i=this.parameters.cooldownTime,n=new AttackDelayEffect(this.owner,t,1/0,e,i);this.owner.addEffect(n,t)},window.QuickDrawAbility=function(t){Ability.call(this,t)},QuickDrawAbility.prototype=Object.create(Ability.prototype),QuickDrawAbility.prototype.constructor=Ability,QuickDrawAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=0,i=this.parameters.cooldownTime,n=new AttackDelayEffect(this.owner,t,1/0,e,i);this.owner.addEffect(n,t)},window.TeamStrengthBoostAbility=function(t){Ability.call(this,t)},TeamStrengthBoostAbility.prototype=Object.create(Ability.prototype),TeamStrengthBoostAbility.prototype.constructor=Ability,TeamStrengthBoostAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=this.parameters.strength,i=this.owner,n=this.owner.stage,a=n.condition.abilityToAll;n.units.forEach(function(n){if(1==n.group&&(a||n==i)){var s=new EnforceStrengthEffect(n,t,1/0,e);n.addEffect(s,t)}})},window.TeamDefenceBoostAbility=function(t){Ability.call(this,t)},TeamDefenceBoostAbility.prototype=Object.create(Ability.prototype),TeamDefenceBoostAbility.prototype.constructor=Ability,TeamDefenceBoostAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=this.parameters.defence,i=this.owner,n=this.owner.stage,a=n.condition.abilityToAll;n.units.forEach(function(n){if(1==n.group&&(a||n==i)){var s=new EnforceDefenceEffect(n,t,1/0,e);n.addEffect(s,t)}})},window.ClassifiedStrengthBoostAbility=function(t){Ability.call(this,t)},ClassifiedStrengthBoostAbility.prototype=Object.create(Ability.prototype),ClassifiedStrengthBoostAbility.prototype.constructor=Ability,ClassifiedStrengthBoostAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=this.parameters.strength,i=this.parameters.classes,n=this.owner,a=this.owner.stage,s=a.condition.abilityToAll;a.units.forEach(function(a){var o=a.group&&(s||a==n),r=i.some(function(t){return a["class"]&&t==a["class"].id});if(o&&r){var l=new EnforceStrengthEffect(a,t,1/0,e);a.addEffect(l,t)}})},window.ClassifiedDefenceBoostAbility=function(t){Ability.call(this,t)},ClassifiedDefenceBoostAbility.prototype=Object.create(Ability.prototype),ClassifiedDefenceBoostAbility.prototype.constructor=Ability,ClassifiedDefenceBoostAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=this.parameters.defence,i=this.parameters.classes,n=this.owner,a=this.owner.stage,s=a.condition.abilityToAll;a.units.forEach(function(a){var o=a.group&&(s||a==n),r=i.some(function(t){return a["class"]&&t==a["class"].id});if(o&&r){var l=new EnforceDefenceEffect(a,t,1/0,e);a.addEffect(l,t)}})},window.SnipeAbility=function(t){Ability.call(this,t)},SnipeAbility.prototype=Object.create(Ability.prototype),SnipeAbility.prototype.constructor=Ability,SnipeAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=0,i=this.parameters.cooldownTime,n=new AttackDelayEffect(this.owner,t,1/0,e,i);this.owner.addEffect(n,t)},window.WhiteMagicAbility=function(t){Ability.call(this,t)},WhiteMagicAbility.prototype=Object.create(Ability.prototype),WhiteMagicAbility.prototype.constructor=Ability,WhiteMagicAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=0,i=this.parameters.cooldownTime,n=new AttackDelayEffect(this.owner,t,1/0,e,i);this.owner.addEffect(n,t)},window.BlackMagicAbility=function(t){Ability.call(this,t)},BlackMagicAbility.prototype=Object.create(Ability.prototype),BlackMagicAbility.prototype.constructor=Ability,BlackMagicAbility.prototype.start=function(t){this.__proto__.__proto__.start.call(this,t);var e=0,i=this.parameters.cooldownTime,n=new AttackDelayEffect(this.owner,t,1/0,e,i);this.owner.addEffect(n,t)},window.QuickHealingPrayerSkill=function(t,e,i){Skill.call(this,t,e,i)},QuickHealingPrayerSkill.prototype=Object.create(Skill.prototype),QuickHealingPrayerSkill.prototype.constructor=Skill,QuickHealingPrayerSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=this.getDuration(),i=new SwitchHealerEffect(this.owner,t,e);this.owner.addEffect(i,t);var n=this.getAttackCooldownCorrection();i=new AttackDelayEffect(this.owner,t,e,1,n),this.owner.addEffect(i,t)},QuickHealingPrayerSkill.prototype.getAttackCooldownCorrection=function(){return this.param.attackCooldownBase+this.param.attackCooldownRate*(this.level-1)},window.RecoveryCostSkill=function(t,e,i){Skill.call(this,t,e,i)},RecoveryCostSkill.prototype=Object.create(Skill.prototype),RecoveryCostSkill.prototype.constructor=Skill,RecoveryCostSkill.prototype.execute=function(t){Skill.prototype.execute.call(this,t);var e=new RecoveryCostEffect(this.owner,t,0,this.param.point);this.owner.addEffect(e,t)},window.RecoveryCostEffect=function(t,e,i,n){Effect.call(this,t,e,i),this.name="出撃コスト回復",this.point=n},RecoveryCostEffect.prototype=Object.create(Effect.prototype,{}),RecoveryCostEffect.prototype.constructor=Effect,RecoveryCostEffect.prototype.update=function(t){Effect.prototype.update.call(this,t),this.expired||(this.owner.stage.addCost(this.point,this.owner,t),this.expired=!0)},RecoveryCostEffect.prototype.dump=function(){return"コスト回復量:"+this.point},window.DestroyedCostBonusEffect=function(t,e,i,n){Effect.call(this,t,e,i),this.name="撃破時コスト回復",this.point=n,t.callbacks.destroyed=function(e,i){this.stage.addCost(n,t,i)}},DestroyedCostBonusEffect.prototype=Object.create(Effect.prototype,{}),DestroyedCostBonusEffect.prototype.constructor=Effect,DestroyedCostBonusEffect.prototype.dump=function(){return"コスト回復量:"+this.point},window.Database=function(t){this.url=t},Database.prototype=Object.create(Object.prototype),Database.prototype.constructor=Object,Database.prototype.buildQueryUrl=function(t){return this.url+"?sheet="+encodeURIComponent(t)},Database.prototype.query=function(t,e,i){var n=this.buildQueryUrl(t),a=new google.visualization.Query(n);a.send(function(t){var n;try{n=Database.handleQueryResponse(t)}catch(a){i(a)}e(n)})},Database.handleQueryResponse=function(t){if(t.isError())throw new Error(t.getMessage()+" "+t.getDetailedMessage());for(var e=t.getDataTable(),i=[],n=0;n<e.getNumberOfColumns();n++)i[n]=e.getColumnLabel(n);var a=i[0],s={};for(n=0;n<e.getNumberOfRows();n++){for(var o={},r=0;r<i.length;r++)o[i[r]]=e.getValue(n,r);var l=o[a];l&&(s[l]=o)}return s}}).call(window)},35:function(t,e){"use strict";function i(t,e){return e=void 0===e?2:e,t=t===1/0||t===-(1/0)?"∞":(t/1e3).toFixed(e),t+"秒"}t.exports=i}});